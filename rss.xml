<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
      <title>sanhuzhen&#x27;s blog</title>
      <link>https://blog.sanhuzhen.top</link>
      <description>sanhuzhen&#x27;s blog</description>
      <generator>Zola</generator>
      <language>en</language>
      <atom:link href="https://blog.sanhuzhen.top/rss.xml" rel="self" type="application/rss+xml"/>
      <lastBuildDate>Tue, 03 Feb 2026 00:00:00 +0000</lastBuildDate>
      <item>
          <title>åç¨‹</title>
          <pubDate>Tue, 03 Feb 2026 00:00:00 +0000</pubDate>
          <author>Unknown</author>
          <link>https://blog.sanhuzhen.top/posts/xie-cheng/</link>
          <guid>https://blog.sanhuzhen.top/posts/xie-cheng/</guid>
          <description xml:base="https://blog.sanhuzhen.top/posts/xie-cheng/">&lt;ol&gt;
&lt;li&gt;è½»é‡ï¼šå ç”¨å†…å­˜å°‘&lt;&#x2F;li&gt;
&lt;li&gt;å‡å°‘å›è°ƒï¼šä»¥åŒæ­¥çš„æ–¹å¼æ‰§è¡Œå¼‚æ­¥ä»£ç ï¼ˆä¼šå°†å‡½æ•°æŒ‚èµ·ç­‰å¾…ç»“æœï¼‰&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;h1 id=&quot;zhuang-tai-ji-yuan-li&quot;&gt;çŠ¶æ€æœºåŸç†&lt;&#x2F;h1&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;suspend fun getData(): String {
    delay(1000)
    return &amp;quot;hello coroutines&amp;quot;
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;åç¼–è¯‘&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Java&quot;&gt;&#x2F;&#x2F; suspendæŒ‚èµ·å‡½æ•°ï¼Œä¼šä¸»åŠ¨åœ¨æ–¹æ³•ä¸­æ·»åŠ Continuationç±»å‹å‚æ•°
@Nullable
public final Object getData(@NotNull Continuation $completion) {
    Continuation $continuation;
    label20: {
        &#x2F;**
â€‹         * å¦‚æœä¼ å…¥çš„Continuationæ˜¯&amp;lt;undefinedtype&amp;gt;ç±»å‹ï¼Œè¯´æ˜æ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨
â€‹         * å¦‚æœä¸æ˜¯ï¼Œåˆ™è¯´æ˜æ˜¯æ¢å¤è°ƒç”¨ï¼Œä»$continuationä¸­è·å–çŠ¶æ€æœºçš„çŠ¶æ€
â€‹         *&#x2F;
â€‹        â€‹if ($completion instanceof &amp;lt;undefinedtype&amp;gt;) {
            $continuation = (&amp;lt;undefinedtype&amp;gt;)$completion;
            if (($continuation.label &amp;amp; Integer.MIN_VALUE) != 0) {
                $continuation.label -= Integer.MIN_VALUE;
                break label20;
            }
        }

        $continuation = new ContinuationImpl($completion) {
            &#x2F;&#x2F; $FF: synthetic field
            Object result; &#x2F;&#x2F; å­˜å‚¨ä¸­é—´ç»“æœ
            int label; &#x2F;&#x2F; æ ‡ç­¾çŠ¶æ€

            &#x2F;&#x2F; è‡ªå·±invokeæ–¹æ³•ï¼Œå®ç°çŠ¶æ€æœºæ¢å¤é€»è¾‘
            @Nullable
            public final Object invokeSuspend(@NotNull Object $result) {
                this.result = $result;
                this.label |= Integer.MIN_VALUE;
                return MainActivity.this.getData((Continuation)this);
            }
        };
    }
    
    &#x2F;&#x2F; å¼€å§‹æ‰§è¡Œé€»è¾‘
    Object $result = $continuation.result;
    Object var4 = IntrinsicsKt.getCOROUTINE_SUSPENDED();
    &#x2F;&#x2F; æ ¹æ®continuationçš„æ ‡ç­¾ä½ï¼Œè¿›è¡Œå¯¹åº”çš„æ“ä½œ
    switch ($continuation.label) {
        case 0:
            &#x2F;&#x2F; æ£€æŸ¥ç»“æœæ˜¯å¦æ˜¯å¼‚å¸¸ï¼Œå¦‚æœæ˜¯åˆ™æŠ›å‡º
            ResultKt.throwOnFailure($result);
            &#x2F;&#x2F; è®¾ç½®ä¸‹ä¸€ä¸ªæ ‡ç­¾
            $continuation.label = 1;
            &#x2F;&#x2F; æ‰§è¡ŒdelayæŒ‚èµ·æ“ä½œï¼Œdelayæ“ä½œé‡Œé¢ä¼šæ‰§è¡Œcontinuation.resumeWith(Result.success(Unit))æ“ä½œï¼Œè¿™é‡Œä¼šè°ƒç”¨continuationçš„invokeSuspendæ–¹æ³•
            if (DelayKt.delay(1000L, $continuation) == var4) {
                return var4;
            }
            break;
        case 1:
            &#x2F;&#x2F; ç»§ç»­æ£€æŸ¥ï¼Œæ— è¯¯è·³å‡ºswitchï¼Œæ‰§è¡Œåç»­é€»è¾‘
            ResultKt.throwOnFailure($result);
            break;
        default:
            throw new IllegalStateException(&amp;quot;call to &amp;#39;resume&amp;#39; before &amp;#39;invoke&amp;#39; with coroutine&amp;quot;);
    }

    return &amp;quot;hello coroutines&amp;quot;;
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä¸Šè¿°æ“ä½œè¢«ç§°ä¸ºæŒ‚èµ·å‡½æ•°çš„CSPæ“ä½œ&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;åç¨‹ä¾èµ–äºåº•å±‚&lt;&#x2F;strong&gt;â€‹&lt;strong&gt;çš„çŠ¶æ€æœºå®ç°æŒ‚èµ·å’Œæ¢å¤ï¼Œå½“é‡åˆ°æŒ‚èµ·ç‚¹æ—¶ï¼Œä¼šå»å°†å½“å‰åç¨‹æŒ‚èµ·ï¼Œå¹¶æ›´æ–°å…¶å†…éƒ¨çš„çŠ¶æ€ï¼Œå°†&lt;code&gt;continuation&lt;&#x2F;code&gt;&lt;strong&gt;â€‹&lt;&#x2F;strong&gt;çš„&lt;code&gt;label&lt;&#x2F;code&gt;&lt;strong&gt;â€‹&lt;&#x2F;strong&gt;æ ‡ç­¾è®¾ç½®ä¸ºä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„&lt;&#x2F;strong&gt;â€‹&lt;strong&gt;ä»£ç å—ç¼–å·ï¼Œå½“è¦æ¢å¤çš„æ—¶å€™ï¼Œåç¨‹å†…éƒ¨ä¼šè°ƒç”¨&lt;&#x2F;strong&gt;â€‹**&lt;code&gt;continuation&lt;&#x2F;code&gt;çš„&lt;strong&gt;â€‹&lt;&#x2F;strong&gt;&lt;code&gt;resumWith&lt;&#x2F;code&gt;æ–¹æ³•ï¼Œå»æ¢å¤åç¨‹è¿è¡Œï¼ŒçŠ¶æ€æœºæ ¹æ®ä¿å­˜çš„labelå€¼è·³è½¬åˆ°å¯¹åº”ä½ç½®ç»§ç»­æ‰§è¡Œåç»­ä»£ç ã€‚**&lt;&#x2F;p&gt;
&lt;h1 id=&quot;gua-qi-han-shu&quot;&gt;æŒ‚èµ·å‡½æ•°&lt;&#x2F;h1&gt;
&lt;h2 id=&quot;delay&quot;&gt;delay&lt;&#x2F;h2&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;delay(1000)
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æŒ‚èµ·1s&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;public suspend fun delay(timeMillis: Long) {
    if (timeMillis &amp;lt;= 0) return &#x2F;&#x2F; don&amp;#39;t delay
    return suspendCancellableCoroutine sc@ { â€‹cont: CancellableContinuation&amp;lt;Unit&amp;gt; -&amp;gt;
â€‹        â€‹&#x2F;&#x2F; if timeMillis == Long.MAX_VALUE then just wait forever like awaitCancellation, don&amp;#39;t schedule.
        if (timeMillis &amp;lt; Long.MAX_VALUE) {
            cont.context.delay.scheduleResumeAfterDelay(timeMillis, cont)
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;withcontext&quot;&gt;withContext&lt;&#x2F;h2&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;withContext(Dispatchers.IO) {
â€‹    â€‹
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;åˆ‡æ¢åç¨‹æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆæ”¹å˜å…¶è¿è¡Œçš„çº¿ç¨‹ï¼‰&lt;&#x2F;p&gt;
&lt;h2 id=&quot;asynche-await&quot;&gt;asyncå’Œawait&lt;&#x2F;h2&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;val dataDeferred = GlobalScope.async {
    &amp;quot;xxx&amp;quot;
}
val data = dataDeferred .await()
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¼€å¯å¹¶å‘åç¨‹å¹¶è·å–ç»“æœ&lt;&#x2F;p&gt;
&lt;h2 id=&quot;launch&quot;&gt;launch&lt;&#x2F;h2&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;GlobalScope.launch â€‹{
â€‹    â€‹
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¹¶ä¸æ˜¯ä¼ ç»Ÿçš„æŒ‚èµ·å‡½æ•°ï¼Œå¯ä»¥è®¾ç½®åç¨‹ä¸Šä¸‹æ–‡ï¼Œä»¥åŠåç¨‹å¯åŠ¨æ–¹å¼&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;åç¨‹ä¸Šä¸‹æ–‡&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;Dispatchers.Mainï¼šAndroidä¸“å±ï¼Œä¸»çº¿ç¨‹ï¼Œåç¨‹ä»£ç é€šè¿‡å°è£…æˆRunnableæ‰§è¡Œ&lt;&#x2F;li&gt;
&lt;li&gt;Dispatchers.IOï¼šIOå¯†é›†ï¼Œç½‘ç»œè¯·æ±‚ï¼Œæ•°æ®åº“æ“ä½œï¼Œæ–‡ä»¶è¯»å–ç­‰IOæ“ä½œ&lt;&#x2F;li&gt;
&lt;li&gt;Dispatchers.Defaultï¼šCPUå¯†é›†ï¼Œå¦‚å¤§é‡è®¡ç®—ï¼Œå¤„ç†æ•°æ®ï¼ˆæ³¨æ„ï¼šä¸èƒ½æ”¾åˆ°IOé‡Œé¢ï¼Œä¼šé˜»å¡ç½‘ç»œè¯·æ±‚ï¼‰&lt;&#x2F;li&gt;
&lt;li&gt;Dispatchers.Unconfinedï¼šçº¯æŒ‚èµ·é€»è¾‘ã€æ— è€—æ—¶çš„åç¨‹è°ƒåº¦&lt;&#x2F;li&gt;
&lt;li&gt;Dispatchers.Main.immediateï¼šAndroidä¸“å±ï¼Œä¸»çº¿ç¨‹å†…çš„æŒ‚èµ·åç«‹å³æ‰§è¡Œé€»è¾‘&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;æ³¨æ„ï¼šåç¨‹ä¸­å”¯ä¸€æ¨èçš„åˆ‡æ¢ä¸Šä¸‹æ–‡çš„æ–¹æ³•å°±æ˜¯&lt;code&gt;withContext&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;åç¨‹çš„å¯åŠ¨æ–¹å¼&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;DEFAULT - ç«‹å³è°ƒåº¦&lt;&#x2F;em&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;launch(start = CoroutineStart.DEFAULT) {
    &#x2F;&#x2F; åˆ›å»ºåç«‹å³è¿›å…¥è°ƒåº¦é˜Ÿåˆ—
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;&lt;em&gt;LAZY - æ‡’å¯åŠ¨&lt;&#x2F;em&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;val job = launch(start = CoroutineStart.LAZY) {
    &#x2F;&#x2F; éœ€è¦æ‰‹åŠ¨å¯åŠ¨
}
job.start()  &#x2F;&#x2F; å¯åŠ¨åç¨‹ï¼Œè¿›å…¥ ACTIVE çŠ¶æ€
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;&lt;em&gt;ATOMIC - åŸå­å¯åŠ¨ï¼ˆä¸å¯å–æ¶ˆï¼‰&lt;&#x2F;em&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;launch(start = CoroutineStart.ATOMIC) {
    &#x2F;&#x2F; å¯åŠ¨åç«‹å³æ‰§è¡Œï¼Œä¸å¯å–æ¶ˆ
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;&lt;em&gt;UNDISPATCHED - ç«‹å³åœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œ&lt;&#x2F;em&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;launch(start = CoroutineStart.UNDISPATCHED) {
    &#x2F;&#x2F; ç«‹å³åœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªæŒ‚èµ·ç‚¹
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;blockquote&gt;
&lt;h2 id=&quot;runblocking&quot;&gt;runBlocking&lt;&#x2F;h2&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;runBlocking â€‹{

}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;é˜»å¡çº¿ç¨‹çš„æŒ‚èµ·å‡½æ•°&lt;&#x2F;p&gt;
&lt;h1 id=&quot;sheng-ming-zhou-qi&quot;&gt;ç”Ÿå‘½å‘¨æœŸ&lt;&#x2F;h1&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Plain&quot;&gt;New (æ–°å»º) â†’ Active (æ´»è·ƒ) â†’ Completing (å®Œæˆä¸­) â†’ Completed (å·²å®Œæˆ)
                â†“
            Cancelling (å–æ¶ˆä¸­) â†’ Cancelled (å·²å–æ¶ˆ)
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre&gt;&lt;code data-lang=&quot;JavaScript&quot;&gt;suspend fun getData() {
    val job = CoroutineScope(Dispatchers.IO).launch(
        &#x2F;&#x2F; æ‡’å¯åŠ¨
        start = CoroutineStart.LAZY
â€‹    â€‹) {
â€‹        â€‹Log.d(TAG, &amp;quot;getData() is running...&amp;quot; + Thread.currentThread().name)
    }

â€‹    â€‹&#x2F;&#x2F; æ¥å¯åŠ¨åç¨‹ï¼Œæ­¤æ—¶å…¶çŠ¶æ€ä¸ºNEW

    val job1 = CoroutineScope(Dispatchers.IO).launchâ€‹ â€‹{
â€‹        â€‹&#x2F;&#x2F; å¤„äºACTIVEçŠ¶æ€
        Log.d(TAG, &amp;quot;getData() is running...&amp;quot; + Thread.currentThread().name)

        delay(1000) &#x2F;&#x2F; æŒ‚èµ·ç‚¹ï¼Œä»ç„¶å¤„äºACTIVEçŠ¶æ€

        Log.d(TAG, &amp;quot;getData() is running...&amp;quot; + Thread.currentThread().name)

        &#x2F;&#x2F; å¦‚æœæ²¡æœ‰å¼‚å¸¸å’Œå–æ¶ˆï¼Œè¿›å…¥ COMPLETINGçŠ¶æ€
    }

â€‹    â€‹val job2 = CoroutineScope(Dispatchers.IO).launchâ€‹ â€‹{
â€‹        â€‹try {
            repeat(100) { â€‹i -&amp;gt;
â€‹                â€‹Log.d(TAG, &amp;quot;job: I am $i&amp;quot;)
                delay(500)
            }
â€‹        â€‹} finally {
            &#x2F;&#x2F; åç¨‹å–æ¶ˆä»ç„¶ä¼šæ‰§è¡Œ
            Log.d(TAG, &amp;quot;job: I am running finally&amp;quot;)

            withContext(NonCancellable) {
â€‹                â€‹delay(1000)
            }
â€‹        â€‹}
    }

â€‹    â€‹delay(1300)
    job2.cancel() &#x2F;&#x2F; å–æ¶ˆåç¨‹ï¼Œè¿›å…¥ CANCELING çŠ¶æ€
    job2.join() &#x2F;&#x2F; ç­‰å¾…åç¨‹ç»“æŸï¼Œè¿›å…¥ CANCELLED çŠ¶æ€
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;zhuang-tai-jian-ting&quot;&gt;çŠ¶æ€ç›‘å¬&lt;&#x2F;h2&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;val job = launch â€‹{
â€‹    â€‹&#x2F;&#x2F; åç¨‹æ‰§è¡Œ
}

&#x2F;&#x2F; 1. ç›‘å¬å®Œæˆ
job.invokeOnCompletion { â€‹cause -&amp;gt;
â€‹    â€‹println(&amp;quot;åç¨‹å®Œæˆï¼ŒåŸå› : $cause&amp;quot;)
}

&#x2F;&#x2F; 2. æ£€æŸ¥çŠ¶æ€
println(&amp;quot;æ˜¯å¦æ´»è·ƒ: ${job.isActive}&amp;quot;)
println(&amp;quot;æ˜¯å¦å®Œæˆ: ${job.isCompleted}&amp;quot;)
println(&amp;quot;æ˜¯å¦å–æ¶ˆ: ${job.isCancelled}&amp;quot;)

&#x2F;&#x2F; 3. ç­‰å¾…å®Œæˆ
runBlocking â€‹{
â€‹    â€‹job.join()  &#x2F;&#x2F; æŒ‚èµ·ç›´åˆ°åç¨‹å®Œæˆ
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h1 id=&quot;xie-cheng-zuo-yong-yu&quot;&gt;åç¨‹ä½œç”¨åŸŸ&lt;&#x2F;h1&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;@Suppress(&amp;quot;FunctionName&amp;quot;)
public fun CoroutineScope(context: CoroutineContext): CoroutineScope =
    ContextScope(if (context[Job] != null) context else context + Job())
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å®šä¹‰åç¨‹çš„ç”Ÿå‘½å‘¨æœŸä»¥åŠæ‰§è¡Œçš„ä¸Šä¸‹æ–‡&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šä½œç”¨åŸŸå–æ¶ˆæ—¶ï¼Œå†…éƒ¨æ‰€æœ‰åç¨‹è‡ªåŠ¨å–æ¶ˆ&lt;&#x2F;li&gt;
&lt;li&gt;ç»“æ„åŒ–å¹¶å‘ï¼šç»„ç»‡åç¨‹çš„çˆ¶å­å…³ç³»&lt;&#x2F;li&gt;
&lt;li&gt;ä¸Šä¸‹æ–‡ä¼ æ’­ï¼šæä¾›é»˜è®¤çš„è°ƒåº¦å™¨ã€å¼‚å¸¸å¤„ç†å™¨ç­‰&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;h2 id=&quot;globalscope&quot;&gt;GlobalScope&lt;&#x2F;h2&gt;
&lt;p&gt;ç”Ÿå‘½å‘¨æœŸä¸åº”ç”¨ä¸€æ ·ï¼Œå°½é‡é¿å…ä½¿ç”¨ï¼Œå®¹æ˜“é€ æˆå†…å­˜æ³„æ¼&lt;&#x2F;p&gt;
&lt;h2 id=&quot;mainscope&quot;&gt;MainScope&lt;&#x2F;h2&gt;
&lt;p&gt;ç”¨äºéAndroidç¯å¢ƒçš„ä¸»çº¿ç¨‹ä½œç”¨åŸŸ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;private val scope = MainScope()  &#x2F;&#x2F; â€‹Dispatchers.Main + SupervisorJob()
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;viewmodelscope&quot;&gt;ViewModelScope&lt;&#x2F;h2&gt;
&lt;p&gt;é€‚ç”¨äºviewmodelçš„ä½œç”¨åŸŸ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;implementation(&amp;quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.8.0&amp;quot;)
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;viewModelScope.launch â€‹{
â€‹    â€‹&#x2F;&#x2F; é‡Œé¢çš„å†…å®¹ä¼šéšç€viewmodelè¢«clearè€Œå–æ¶ˆ
}

class MainViewModel: ViewModel() {
    val scope = CoroutineScope(Dispatchers.IO + SupervisorJob())
    
    &#x2F;&#x2F; å¦‚æœè¦è‡ªå®šä¹‰çš„è¯ï¼Œè®°å¾—å–æ¶ˆä½œç”¨åŸŸ
    override fun onCleared() {
        super.onCleared()
        scope.cancel()
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lifecyclescope&quot;&gt;LifecycleScope&lt;&#x2F;h2&gt;
&lt;p&gt;é€‚ç”¨äºactivityçš„ä½œç”¨åŸŸ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;implementation(&amp;quot;androidx.lifecycle:lifecycle-runtime-ktx:2.8.0&amp;quot;)
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;lifecycleScope.launch â€‹{
â€‹    â€‹&#x2F;&#x2F; é‡Œé¢çš„å†…å®¹ä¼šéšç€activityè¢«destoryè€Œå–æ¶ˆ
}

&#x2F;&#x2F; ä»¥ä¸‹æ–¹æ³•åœ¨ç”Ÿå‘½å‘¨æœŸç¦»å¼€å¯¹åº”çŠ¶æ€æ—¶ä¼šæŒ‚èµ·åç¨‹
lifecycleScope.launchWhenCreated { }   &#x2F;&#x2F; CREATEDçŠ¶æ€
lifecycleScope.launchWhenStarted { }   &#x2F;&#x2F; STARTEDçŠ¶æ€  â€‹
lifecycleScope.launchWhenResumed { }   &#x2F;&#x2F; RESUMEDçŠ¶æ€
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;zi-ding-yi-scope&quot;&gt;è‡ªå®šä¹‰Scope&lt;&#x2F;h2&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;class MyCustomScope : CoroutineScope {
    private val job = SupervisorJob()

    override val coroutineContext: CoroutineContext
        get() = Dispatchers.Main + job + CoroutineName(&amp;quot;MyScope&amp;quot;)

    fun cleanup() {
        job.cancel()  &#x2F;&#x2F; å–æ¶ˆæ‰€æœ‰å­åç¨‹
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;supervisorjob-vs-job&quot;&gt;SupervisorJob vs Job&lt;&#x2F;h3&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Java&quot;&gt;&#x2F;&#x2F; 1. ä½¿ç”¨ Jobï¼ˆé»˜è®¤ï¼‰- å­åç¨‹å¼‚å¸¸ä¼šä¼ æ’­
val scope1 = CoroutineScope(Job() + Dispatchers.Main)
scope1.launch {
    launch â€‹{
â€‹        â€‹throw Exception()  &#x2F;&#x2F; ä¼šå–æ¶ˆçˆ¶åç¨‹å’Œå…¶ä»–å­åç¨‹
    }
â€‹    â€‹launch â€‹{
â€‹        â€‹delay(1000)  &#x2F;&#x2F; è¿™ä¸ªä¸ä¼šæ‰§è¡Œï¼Œå› ä¸ºè¢«å¼‚å¸¸å–æ¶ˆäº†
    }
}

&#x2F;&#x2F; 2. ä½¿ç”¨ SupervisorJob - å­åç¨‹å¼‚å¸¸éš”ç¦»
val scope2 = CoroutineScope(SupervisorJob() + Dispatchers.Main)
scope2.launch {
    launch â€‹{
â€‹        â€‹throw Exception()  &#x2F;&#x2F; åªå½±å“è‡ªå·±
    }
â€‹    â€‹launch â€‹{
â€‹        â€‹delay(1000)  &#x2F;&#x2F; è¿™ä¸ªæ­£å¸¸æ‰§è¡Œ
        println(&amp;quot;æˆ‘è¿˜æ´»ç€&amp;quot;)
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</description>
      </item>
      <item>
          <title>2025å¹´æ€»ç»“</title>
          <pubDate>Wed, 31 Dec 2025 00:00:00 +0000</pubDate>
          <author>Unknown</author>
          <link>https://blog.sanhuzhen.top/posts/2025nian-zong-jie/</link>
          <guid>https://blog.sanhuzhen.top/posts/2025nian-zong-jie/</guid>
          <description xml:base="https://blog.sanhuzhen.top/posts/2025nian-zong-jie/">&lt;p&gt;â€‹   å“ˆå“ˆï¼Œæƒ³èµ·æ¥æˆ‘è¿˜æœ‰ä¸ªåšå®¢äº†ï¼ŒåŒæ—¶ä»Šå¹´ä¹Ÿå‘ç”Ÿäº†ä¸å°‘äº‹ï¼Œå°±å†™ä¸€å†™æˆ‘çš„ç¬¬ä¸€ç¯‡å¹´åº¦æ€»ç»“å§ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;shi-xi&quot;&gt;å®ä¹ &lt;&#x2F;h2&gt;
&lt;p&gt;â€‹	é¦–å½“å…¶å†²çš„åº”è¯¥å°±æ˜¯å®ä¹ è¿™ä»¶äº‹äº†ï¼Œä»Šå¹´æ€»å…±åœ¨ä¸¤å®¶å…¬å¸å¾…è¿‡â€”â€”TMEå’Œå°ç±³ï¼Œå…ˆè°ˆè°ˆTMEå§ï¼Œç®—æ˜¯æˆ‘çš„ç¬¬ä¸€æ®µå®ä¹ ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;â€‹	å¯¹äºTMEçš„è¯ï¼Œæˆ‘åº”è¯¥æ˜¯å…«æœˆä¸­æ—¬æ‹¿åˆ°offerçš„ï¼Œç„¶åå°±ä¹‰æ— åé¡¾å‰å¾€äº†ç‰›é©¬åŸå¸‚â€”â€”æ·±åœ³ï¼Œä½†æ²¡å¾…åˆ°ä¸€ä¸ªæœˆå°±è·‘è·¯äº†ã€‚è¿›å»å‰å……æ»¡äº†æœŸå¾…ï¼Œæ¯•ç«Ÿç¬¬ä¸€æ¬¡å˜›ï¼Œè¿˜æœ‰ç€è…¾è®¯çš„buffåœ¨ï¼Œä½†è¿›å»ä¹‹åï¼Œæ„Ÿè§‰åˆ°æœ‰ç‚¹ä¸å¯¹åŠ²äº†ï¼Œé¦–å…ˆï¼ŒTMEå¯¹äºæ—¥å¸¸å®ä¹ ç”Ÿå¾…é‡è¿˜æ˜¯æœ‰ç‚¹å·®çš„ï¼ŒåŒæ—¶å·¥å¡æ–¹é¢ç¢°å·§è¿‡å»çš„æ—¶å€™ï¼Œå¤–é¢çš„ç…§ç›¸æœºåäº†ï¼Œå¯¼è‡´æˆ‘åˆšå»çš„ä¸€å‘¨ä¸€ç›´æ²¡æœ‰æ‹¿åˆ°å·¥å¡ï¼Œè¿›å»åªèƒ½å‘æ­£èŒç”³è¯·é—¨ç¦æƒé™ï¼Œå½“ç„¶ï¼Œè¿™å‡ ç‚¹è¿˜æ˜¯ä¸èƒ½ä¿ƒä½¿æˆ‘è·‘è·¯çš„æƒ³æ³•ï¼Œæœ€ä»¤æˆ‘æƒ³è·‘è·¯çš„æ˜¯å…¬å¸çš„æ—¥å¸¸å®ä¹ ç”Ÿæ¥è§¦ä¸åˆ°ä¸šåŠ¡æ–¹é¢ï¼Œå¯¼è‡´è‡ªå·±åœ¨å¤§å‚æµç¨‹è§„èŒƒæ ¹æœ¬å­¦ä¸åˆ°ä¸€ç‚¹ä¸œè¥¿ï¼ŒåŒæ—¶ä¹Ÿä¸èƒ½åœ¨ä»£ç é‡Œé¢è¿›è¡Œå®æ“ï¼Œå“ˆå“ˆï¼Œè¢«ç§°ä¸ºå®¢æœå°æ¸¸äº†ï¼Œè¿˜æœ‰ç»„å†…çš„æ°›å›´æ¯”è¾ƒå·®å§ï¼Œæ‰€ä»¥æˆ‘åœ¨ä¸åˆ°ä¸€ä¸ªæœˆçš„æ—¶é—´å†…æäº¤äº†è¾èŒï¼Œç«é€Ÿè·‘è·¯äº†ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;â€‹	å›åˆ°å­¦æ ¡åï¼Œæƒ³å†æ‰¾ä¸€æ®µå®ä¹ ç»å†ï¼Œæ¯•ç«ŸTMEè¿™ä¸€æ®µæˆ‘åªæ··åˆ°äº†ä¸ªtitleï¼Œè€ŒçœŸè¦åœ¨é¢è¯•ä¸­è¯´çš„è¯ï¼Œæˆ‘æ„Ÿè§‰å•¥ä¹Ÿè¯´ä¸å‡ºæ¥ã€‚ä¹æœˆæœ¬æ¥æƒ³æ­‡ä¸€ä¸ªæœˆçš„ï¼Œä½†æ»´æ»´é‚£è¾¹ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™æŠ•çš„æ‰¾åˆ°æˆ‘äº†ï¼Œå°±é¢äº†ä¸€ä¸‹ï¼Œç»“æœäºŒé¢æŒ‚äº†ï¼Œéå¸¸å¯æƒœå§ã€‚åé¢åœ¨åæœˆä»½çš„æ—¶å€™ï¼Œæˆ‘é¢äº†æˆ‘ç°åœ¨å°ç±³çš„è¿™ä¸ªç»„ï¼Œä¸€é¢å¾ˆé¡ºåˆ©çš„é€šè¿‡äº†ï¼Œä½†ä¸çŸ¥åé¢ä¸ºå•¥é¸½äº†æˆ‘ï¼ˆè¿›æ¥åé—®äº†ä¸‹ï¼Œå‘Šè¯‰æˆ‘è¯´å¤ªå¿™äº†ğŸ˜‚ï¼‰ï¼Œåœ¨åä¸€æœˆåº•çš„æ—¶å€™é€šè¿‡xhsçŸ¥é“äº†å¯ä»¥å‘é‚®ä»¶ç»™å°ç±³hrï¼Œåé¢æˆåŠŸçº¦ä¸Šäº†äºŒé¢ï¼Œæœ€åä¹Ÿååˆ†å¹¸è¿åœ°é€šè¿‡äº†ï¼Œä¹Ÿåœ¨åäºŒæœˆä»½å…¥èŒäº†ï¼Œåˆ°ç°åœ¨ä¹Ÿæœ‰åŠä¸ªæœˆäº†ï¼Œè¿›æ¥ç»™äº†æˆ‘ä¸€ä¸ªå¤§æƒŠå–œï¼Œå·¦è¾¹leaderï¼Œå³è¾¹mentorï¼Œå˜»å˜»ã€‚ç»„å†…æ°›å›´ä¹Ÿæ¯”è¾ƒå¥½ï¼Œå¹³æ—¶ä¸æ‡‚çš„éƒ½å¯ä»¥å»é—®ï¼Œå¯æƒœå°ç±³è¿˜æ˜¯å¤ªæœ‰æ€§ä»·æ¯”äº†ï¼Œä¸ç„¶è¿˜çœŸæƒ³åœ¨è¿™é‡Œè½¬æ­£ï¼Œå½“ç„¶ï¼Œèµ°ä¸€æ­¥çœ‹ä¸€æ­¥å§ï¼Œä¸èƒ½æŠŠè·¯èµ°æ­»äº†ï¼Œåœ¨ç°åœ¨è¿™ä¸ªäº’è”ç½‘æ°›å›´ä¸‹ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;â€‹	æœ€åè°ˆè°ˆè‡ªå·±å¯¹äºå®ä¹ çš„çœ‹æ³•å§ï¼Œå®ä¹ çš„è¯æˆ‘è§‰å¾—ç¡®å®å¯ä»¥è®©ä¸€ä¸ªäººæˆç†Ÿå¾ˆå¤šï¼Œä¸ç®¡æ˜¯TMEè¿˜æ˜¯å°ç±³ï¼Œéƒ½æ˜¯äººç”Ÿä¸­çš„ä¸€æ®µæˆé•¿å§ï¼Œè¿˜æœ‰å°±æ˜¯èµ°å‡ºäº†æ ¡å›­ï¼Œè¿›å…¥äº†ç¤¾ä¼šï¼Œç¬¬ä¸€æ¬¡ç§Ÿæˆ¿ï¼Œç¬¬ä¸€æ¬¡ä½“ä¼šåˆ°å½“ç¤¾ç•œçš„æ„Ÿè§‰ã€‚å½“ç„¶æœ€åæ„Ÿè°¢ä¸€ä¸‹æˆ‘çš„è¾…å¯¼å‘˜ï¼Œæ„Ÿè°¢ä»–ä¸æ˜¯é‚£ä¹ˆå¤æ¿å§ï¼Œä»¥è¯·å‡çš„åä¹‰æ”¾æˆ‘ä»¬å‡ºæ¥ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lv-you&quot;&gt;æ—…æ¸¸&lt;&#x2F;h2&gt;
&lt;p&gt;â€‹	å½“ç„¶ï¼Œè¿™ä¸€å¹´ä¹Ÿå»äº†ä¸å°‘åœ°æ–¹ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯äº‘å—ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;â€‹	æš‘å‡ä¸ƒæœˆä»½çš„æ—¶å€™å»çš„ï¼Œæ€»å…±å°±å»äº†ä¸¤ä¸ªåŸå¸‚â€”â€”æ˜†æ˜å’Œå¤§ç†ã€‚åªèƒ½è¯´ä¸æ„§æ˜¯æ—…æ¸¸èƒœåœ°ï¼Œäº‘å—é£æ™¯è¿˜æ˜¯æœ‰ç‚¹ä¸œè¥¿çš„ï¼Œå¾ˆç¾ï¼Œç›´æ¥ä¸Šå›¾å§&lt;&#x2F;p&gt;
&lt;img src=&quot;&#x2F;images&#x2F;2025å¹´æ€»ç»“&#x2F;1.jpg&quot; alt=&quot;image-20251231220816894&quot; style=&quot;zoom:25%;&quot; &#x2F;&gt;
&lt;img src=&quot;&#x2F;images&#x2F;2025å¹´æ€»ç»“&#x2F;2.jpg&quot; alt=&quot;image-20251231220904493&quot; style=&quot;zoom:25%;&quot; &#x2F;&gt;
&lt;img src=&quot;&#x2F;images&#x2F;2025å¹´æ€»ç»“&#x2F;3.jpg&quot; alt=&quot;image-20251231220946104&quot; style=&quot;zoom:25%;&quot; &#x2F;&gt;
&lt;img src=&quot;&#x2F;images&#x2F;2025å¹´æ€»ç»“&#x2F;4.jpg&quot; alt=&quot;image-20251231220958403&quot; style=&quot;zoom:25%;&quot; &#x2F;&gt;
&lt;img src=&quot;&#x2F;images&#x2F;2025å¹´æ€»ç»“&#x2F;5.jpg&quot; alt=&quot;image-20251231220958403&quot; style=&quot;zoom:25%;&quot; &#x2F;&gt;
&lt;p&gt;â€‹	å½“ç„¶çœ‹çœ‹åé¢æœ‰æ²¡æœ‰æœºä¼šå»å§ï¼çœŸæƒ³å†å»ä¸€æ¬¡ï¼Œä¸è¿‡ï¼Œæ³¨æ„é˜²æ™’ï¼Œåšä¸»è¢«æ™’ä¼¤äº†ğŸ˜­&lt;&#x2F;p&gt;
&lt;p&gt;â€‹	ç¬¬äºŒä¸ªå°±æ˜¯åšä¸»ç°åœ¨åœ¨çš„åŸå¸‚â€”â€”å—äº¬ã€‚ä¸è¿‡è¿˜æ²¡é€›ï¼Œè¿™å‡ å‘¨æœ‰ç‚¹å¿™ï¼Œå…ƒæ—¦æ‰“ç®—å»é€›é€›ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;wei-lai&quot;&gt;æœªæ¥&lt;&#x2F;h2&gt;
&lt;p&gt;â€‹	æ€»ç»“ä¸€ä¸‹é¡ºä¾¿å¯„è¯­å‡ å¥ç»™2026å¹´çš„è‡ªå·±å§ï¼Œæ€»çš„æ¥è¯´è¿™ä¸€å¹´è¿˜æ˜¯å¹²äº†ä¸å°‘äº‹çš„ï¼Œä¹Ÿå­¦åˆ°äº†å¾ˆå¤šï¼Œå¾ˆæ„Ÿè°¢è‡ªå·±å’Œè¿™ä¸€è·¯é‡åˆ°çš„äººï¼Œå¸Œæœ›è‡ªå·±2026å¹´å¯ä»¥é¡ºé¡ºåˆ©åˆ©å§ï¼&lt;&#x2F;p&gt;
&lt;p&gt;â€‹	æœ€åï¼Œæ–°å¹´å¿«ä¹ï¼ï¼ï¼&lt;&#x2F;p&gt;
</description>
      </item>
      <item>
          <title>Jetpackä»‹ç»</title>
          <pubDate>Wed, 26 Mar 2025 00:00:00 +0000</pubDate>
          <author>Unknown</author>
          <link>https://blog.sanhuzhen.top/posts/jetpackde-shi-yong/</link>
          <guid>https://blog.sanhuzhen.top/posts/jetpackde-shi-yong/</guid>
          <description xml:base="https://blog.sanhuzhen.top/posts/jetpackde-shi-yong/">&lt;h1 id=&quot;shen-me-shi-jetpack&quot;&gt;ä»€ä¹ˆæ˜¯Jetpackï¼Ÿ&lt;&#x2F;h1&gt;
&lt;p&gt;çœ‹ä¸€ä¸‹å®˜æ–¹çš„å®šä¹‰ï¼š&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;Jetpack æ˜¯ä¸€ä¸ªç”±å¤šä¸ªåº“ç»„æˆçš„å¥—ä»¶ï¼Œå¯å¸®åŠ©å¼€å‘è€…éµå¾ªæœ€ä½³åšæ³•ã€å‡å°‘æ ·æ¿ä»£ç å¹¶ç¼–å†™å¯åœ¨å„ç§ Android ç‰ˆæœ¬å’Œè®¾å¤‡ä¸­ä¸€è‡´è¿è¡Œçš„ä»£ç ï¼Œè®©å¼€å‘è€…å¯å°†ç²¾åŠ›é›†ä¸­äºçœŸæ­£é‡è¦çš„ç¼–ç å·¥ä½œã€‚&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;p&gt;ç®€å•æ¥è¯´ï¼ŒJetpackå°±æ˜¯Googleå®˜æ–¹æ¨å‡ºçš„ä¸€å¥—æ–¹ä¾¿å¼€å‘è€…çš„åº“ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨Jetpackå‘¢ï¼Ÿ&lt;&#x2F;p&gt;
&lt;p&gt;åŸå› å°±æ˜¯å› ä¸ºAndroidåœ¨å‘å±•è¿‡ç¨‹ä¸­å‡ºç°äº†è®¸å¤šæ¡†æ¶æ¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿè¿›è¡Œå¼€å‘ï¼Œä½†éšç€è¿™äº›æ¡†æ¶è¶Šæ¥è¶Šå¤šï¼Œå¯¼è‡´äº†å¼€å‘è¶Šæ¥è¶Šç¢ç‰‡åŒ–ï¼Œè¿™æ—¶å€™ï¼Œå¤§å“¥Googleçœ‹ä¸ä¸‹å»äº†ï¼Œæ‰€ä»¥å…¶åœ¨Goole I&#x2F;O 2018å¤§ä¼šä¸Šæ¨å‡ºäº†Android Jetpackã€‚Jetpackå¯å¸®åŠ©å¼€å‘è€…éµå¾ªæœ€ä½³åšæ³•ï¼Œå‡å°‘æ ·æ¿ä»£ç å¹¶ç¼–å†™å¯åœ¨å„ç§ Android ç‰ˆæœ¬å’Œè®¾å¤‡ä¸­ä¸€è‡´è¿è¡Œçš„ä»£ç ï¼Œè®©å¼€å‘è€…ç²¾åŠ›é›†ä¸­ç¼–å†™é‡è¦çš„ä»£ç ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;Jetpackä¸»è¦åŒ…æ‹¬4ä¸ªæ–¹é¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåˆ†åˆ«æ˜¯æ¶æ„ï¼ˆArchitectureï¼‰ã€ç•Œé¢ï¼ˆUIï¼‰ã€è¡Œä¸º ï¼ˆBehaviorï¼‰å’ŒåŸºç¡€ï¼ˆFoundationï¼‰ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;1.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h1 id=&quot;lifecycle&quot;&gt;Lifecycle&lt;&#x2F;h1&gt;
&lt;p&gt;Lifecycleæ˜¯å¾ˆå¤šJetpackç»„ä»¶çš„åŸºç¡€ï¼Œæˆ‘ä»¬å…ˆæ¥è®²è®²å®ƒã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;shen-me-shi-lifecycle&quot;&gt;ä»€ä¹ˆæ˜¯Lifecycleï¼Ÿ&lt;&#x2F;h2&gt;
&lt;p&gt;&lt;a rel=&quot;external&quot; href=&quot;https:&#x2F;&#x2F;developer.android.com&#x2F;topic&#x2F;libraries&#x2F;architecture&#x2F;lifecycle?hl=zh-cn&quot;&gt;Lifecycle&lt;&#x2F;a&gt;æ˜¯ä¸€ä¸ªç±»ï¼Œç”¨äºå­˜å‚¨æœ‰å…³ç»„ä»¶ï¼ˆå¦‚ activity æˆ– fragmentï¼‰çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€çš„ä¿¡æ¯ï¼Œå¹¶å…è®¸å…¶ä»–å¯¹è±¡è§‚æµ‹æ­¤çŠ¶æ€ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;wei-shen-me-yao-yong-lifecycle&quot;&gt;ä¸ºä»€ä¹ˆè¦ç”¨Lifecycle&lt;&#x2F;h2&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨å¤„ç†Activityå’ŒFragmentç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸç›¸å…³æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨onCreateä¸­åˆå§‹åŒ–æŸäº›æˆå‘˜ï¼Œç„¶åå†å…¶ä»–ç”Ÿå‘½å‘¨æœŸä¸­å¯¹è¿™äº›æˆå‘˜è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œæœ€ååœ¨onDestroyä¸­é‡Šæ”¾ä»–ä»¬ã€‚æˆ‘ä»¬åœ¨ä¸€äº›éœ€æ±‚å°çš„æ—¶å€™ï¼Œè¿™æ ·å†™æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†å½“ä½ éœ€æ±‚è¿‡å¤šäº†ï¼Œä½ æŠŠè¿™äº›å…¨éƒ½å†™åˆ°é‡Œé¢ï¼Œä¼šé€ æˆä½ çš„ä»£ç ä¼šéå¸¸å¤æ‚è‡ƒè‚¿ã€‚ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå°±æ¨å‡ºäº†Lifecycleæ¥å¸®åŠ©æˆ‘ä»¬ç”¨ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼æ¥ç›‘å¬ Activityã€Fragment çš„ç”Ÿå‘½å‘¨æœŸå˜åŒ–ï¼Œå¹¶ä¸”ä¼šå¤§å¤§å‡å°‘äº†ä¸šåŠ¡ä»£ç å‘ç”Ÿå†…å­˜æ³„æ¼çš„é£é™©ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lifecyclede-yong-fa&quot;&gt;Lifecycleçš„ç”¨æ³•&lt;&#x2F;h2&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼š@OnLifecycleEvent(Lifecycle.Event.ON_XXX)æ ‡ç­¾å·²ç»è¢«å¼ƒç”¨&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h3 id=&quot;defaultlifecycleobserverjie-kou&quot;&gt;&lt;code&gt;DefaultLifecycleObserver&lt;&#x2F;code&gt;æ¥å£&lt;&#x2F;h3&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;class MyObserver: DefaultLifecycleObserver {
    override fun onCreate(owner: LifecycleOwner) {
        super.onCreate(owner)
        Log.d(&amp;quot;MyObserver&amp;quot;, &amp;quot;onCreate:&amp;quot;)
    }

    override fun onStart(owner: LifecycleOwner) {
        super.onStart(owner)
        Log.d(&amp;quot;MyObserver&amp;quot;, &amp;quot;onStart:&amp;quot;)
    }

    override fun onResume(owner: LifecycleOwner) {
        super.onResume(owner)
        Log.d(&amp;quot;MyObserver&amp;quot;, &amp;quot;onResume:&amp;quot;)
    }

    override fun onPause(owner: LifecycleOwner) {
        super.onPause(owner)
        Log.d(&amp;quot;MyObserver&amp;quot;, &amp;quot;onPause:&amp;quot;)
    }

    override fun onStop(owner: LifecycleOwner) {
        super.onStop(owner)
        Log.d(&amp;quot;MyObserver&amp;quot;, &amp;quot;onStop:&amp;quot;)
    }

    override fun onDestroy(owner: LifecycleOwner) {
        super.onDestroy(owner)
        Log.d(&amp;quot;MyObserver&amp;quot;, &amp;quot;onDestroy:&amp;quot;)
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;åœ¨Activityä¸­æ·»åŠ &lt;code&gt;lifecycle.addObserver(MyObserver())&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;class LifecycleActivity: AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_lifecycle)
        lifecycle.addObserver(MyObserver())
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æŸ¥çœ‹Log&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;2.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;lifecycleeventobserverjie-kou&quot;&gt;&lt;code&gt;LifecycleEventObserver&lt;&#x2F;code&gt;æ¥å£&lt;&#x2F;h3&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;class MyObserver2: LifecycleEventObserver {
    override fun onStateChanged(source: LifecycleOwner, event: Lifecycle.Event) {
        when (event) {
            Lifecycle.Event.ON_CREATE -&amp;gt; {
                Log.d(&amp;quot;MyObserver2&amp;quot;, &amp;quot;onCreate&amp;quot;)
            }
            Lifecycle.Event.ON_START -&amp;gt; {
                Log.d(&amp;quot;MyObserver2&amp;quot;, &amp;quot;onStart&amp;quot;)
            }
            Lifecycle.Event.ON_RESUME -&amp;gt; {
                Log.d(&amp;quot;MyObserver2&amp;quot;, &amp;quot;onResume&amp;quot;)
            }
            Lifecycle.Event.ON_PAUSE -&amp;gt; {
                Log.d(&amp;quot;MyObserver2&amp;quot;, &amp;quot;onPause&amp;quot;)
            }
            Lifecycle.Event.ON_STOP -&amp;gt; {
                Log.d(&amp;quot;MyObserver2&amp;quot;, &amp;quot;onStop&amp;quot;)
            }
            Lifecycle.Event.ON_DESTROY -&amp;gt; {
                Log.d(&amp;quot;MyObserver2&amp;quot;, &amp;quot;onDestroy&amp;quot;)
            }
            else -&amp;gt; {}
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;åŒæ ·åœ¨Activityä¸­æ·»åŠ &lt;code&gt;lifecycle.addObserver(MyObserver2())&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;class LifecycleActivity: AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_lifecycle)
        lifecycle.addObserver(MyObserver2())
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;3.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lifecyclede-yuan-li&quot;&gt;Lifecycleçš„åŸç†&lt;&#x2F;h2&gt;
&lt;p&gt;å¤§å®¶æ˜¯å¦æœ‰è¿™æ ·çš„ç–‘é—®ï¼Œä¸ºä»€ä¹ˆLifecycleå¯ä»¥ç›‘å¬ç”Ÿå‘½å‘¨æœŸï¼Ÿæ‰€ä»¥å¸¦ç€è¿™æ ·çš„ç–‘é—®ï¼Œæˆ‘ä»¬å°±æ¥è®²è®²å…¶åŸç†ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;Lifecycleæ•´ä½“ä¸Šé‡‡ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæä¾›äº†LifecycleOwner(è¢«è§‚å¯Ÿè€…)å’ŒLifecyleObserver(è§‚å¯Ÿè€…)ä¸¤ä¸ªæ¥å£ï¼Œé€šè¿‡è¿™ä¸ªå…¶å°±å¯ä»¥å¯¹é¡µé¢çš„ç”Ÿå‘½å‘¨æœŸè¿›è¡Œç›‘å¬ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å›åˆ°æˆ‘ä»¬çš„Activityä¸­æ¥ï¼Œæˆ‘ä»¬æ³¨å†Œè§‚å¯Ÿè€…ä¸»è¦æ˜¯é€šè¿‡&lt;code&gt;lifecycle&lt;&#x2F;code&gt;è°ƒç”¨&lt;code&gt;addObserver()&lt;&#x2F;code&gt;å®ç°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»è¿™é‡Œä¸‹æ‰‹çœ‹çœ‹è¿™ä¸ª&lt;code&gt;lifecycle&lt;&#x2F;code&gt;æ˜¯å’‹æ¥çš„&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;lifecycle.addObserver(MyObserver())
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å’±ä»¬æŒ‰ä½Ctrlé”®ï¼Œç”¨é¼ æ ‡ç‚¹å‡»&lt;code&gt;lifecycle&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;override val lifecycle: Lifecycle
    get() = super.lifecycle
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™ä¸ªlifecycleæ‹¿çš„æ˜¯å…¶çˆ¶ç±»ä¸­çš„lifecycleï¼Œå’±ä»¬å†ç‚¹è¿›å»&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@RestrictTo(RestrictTo.Scope.LIBRARY_GROUP_PREFIX)
public open class ComponentActivity : Activity(), LifecycleOwner, KeyEventDispatcher.Component {
    ...
    @Suppress(&amp;quot;LeakingThis&amp;quot;) private val lifecycleRegistry = LifecycleRegistry(this)
    ...
    override val lifecycle: Lifecycle
        get() = lifecycleRegistry
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°lifecycleæ‹¿åˆ°çš„æ˜¯ä¸€ä¸ª&lt;code&gt;LifecycleRegistry&lt;&#x2F;code&gt;å¯¹è±¡ï¼Œå¹¶ä¸”å°†å½“å‰çš„Activityä¼ è¿›å»äº†&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä»¬å†æ¥çœ‹çœ‹&lt;code&gt;LifecycleRegistry&lt;&#x2F;code&gt;å¯¹è±¡&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;open class LifecycleRegistry private constructor(
    provider: LifecycleOwner,
    private val enforceMainThread: Boolean
) : Lifecycle() {
    ...
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°LifecycleRegistryç»§æ‰¿äºLifecycleè¿™ä¸ªç±»ï¼Œå¹¶ä¸”åœ¨å…¶æ„é€ æ–¹æ³•ä¸­ä¼ è¿›æ¥ä¸€ä¸ª&lt;code&gt;LifecycleOwner&lt;&#x2F;code&gt;ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;public interface LifecycleOwner {
    &#x2F;**
     * Returns the Lifecycle of the provider.
     *
     * @return The lifecycle of the provider.
     *&#x2F;
    public val lifecycle: Lifecycle
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å®ƒæ˜¯ä¸€ä¸ªæ¥å£ï¼Œé‡Œé¢åªæœ‰ä¸€ä¸ªå˜é‡&lt;code&gt;lifecycle&lt;&#x2F;code&gt;ï¼Œä¸Šé¢è¯´äº†&lt;code&gt;LifecycleRegistry&lt;&#x2F;code&gt;å°†å½“å‰çš„Activityå®ä¾‹ä¼ äº†è¿›æ¥ï¼Œæ‰€ä»¥Activityè‚¯å®šæ˜¯å®ç°äº†&lt;code&gt;LifecycleOwner&lt;&#x2F;code&gt;è¿™ä¸ªæ¥å£çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å°±çŸ¥é“&lt;code&gt;lifecycle&lt;&#x2F;code&gt;æ˜¯æ€ä¹ˆæ¥çš„äº†ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;èŠå®Œlifecycleæ€ä¹ˆæ¥çš„ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¯¦ç»†èŠä¸€èŠå®ƒç©¶ç«Ÿæ€ä¹ˆæ„ŸçŸ¥ç”Ÿå‘½å‘¨æœŸçš„äº†ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å‰é¢æåˆ°äº†&lt;code&gt;LifecycleRegistry&lt;&#x2F;code&gt;ç»§æ‰¿äº&lt;code&gt;Lifecycle&lt;&#x2F;code&gt;è¿™ä¸ªç±»ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å®ƒ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;public abstract class Lifecycle {
    &#x2F;&#x2F; æ·»åŠ è§‚å¯Ÿè€…
    @MainThread
    public abstract fun addObserver(observer: LifecycleObserver)
    &#x2F;&#x2F; ç§»é™¤è§‚å¯Ÿè€…
    @MainThread
    public abstract fun removeObserver(observer: LifecycleObserver)
    &#x2F;&#x2F; å½“å‰çŠ¶æ€
    @get:MainThread
    public abstract val currentState: State
    &#x2F;&#x2F; ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼Œå¯¹åº”Activityç”Ÿå‘½å‘¨æœŸæ–¹æ³•
    public enum class Event {
        ON_CREATE,
        ON_START,
        ON_RESUME,
        ON_PAUSE,
        ON_STOP,
        ON_DESTROY,
        ON_ANY;
        &#x2F;&#x2F; å‘ç”Ÿäº‹ä»¶åçš„çŠ¶æ€
        public val targetState: State
            get() {
                when (this) {
                    ON_CREATE, ON_STOP -&amp;gt; return State.CREATED
                    ON_START, ON_PAUSE -&amp;gt; return State.STARTED
                    ON_RESUME -&amp;gt; return State.RESUMED
                    ON_DESTROY -&amp;gt; return State.DESTROYED
                    ON_ANY -&amp;gt; {}
                }
                throw IllegalArgumentException(&amp;quot;$this has no target state&amp;quot;)
            } 
    }
    &#x2F;&#x2F;ç”Ÿå‘½å‘¨æœŸçŠ¶æ€
    public enum class State {
        DESTROYED,
        INITIALIZED,
        CREATED,
        STARTED,
        RESUMED;
        &#x2F;&#x2F;åˆ¤æ–­è‡³å°‘æ˜¯æŸä¸€çŠ¶æ€
        public fun isAtLeast(state: State): Boolean {
            return compareTo(state) &amp;gt;= 0
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°Lifecycleæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œé‡Œé¢å®šä¹‰äº†ä¸€äº›æŠ½è±¡æ–¹æ³•ä»¥åŠä¸¤ç§æšä¸¾ï¼š&lt;strong&gt;äº‹ä»¶&lt;&#x2F;strong&gt;å’Œ&lt;strong&gt;çŠ¶æ€&lt;&#x2F;strong&gt;ï¼ŒLifecycleæ­£æ˜¯ç”¨è¿™ä¸¤ç§æšä¸¾è·Ÿè¸ªå…¶å…³è”ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ï¼Œå½“æˆ‘ä»¬çš„äº‹ä»¶å‘ç”Ÿåï¼Œæˆ‘ä»¬ä¼šæŠŠLifecycleçš„çŠ¶æ€ä¹Ÿæ”¹å˜ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;okï¼ŒèŠå®ŒLifecycleè¿™ä¸ªç±»ä¹‹åï¼Œæˆ‘ä»¬ä¸Šé¢äº†è§£åˆ°Activityæ˜¯å®ç°äº†&lt;code&gt;LifecycleOwner&lt;&#x2F;code&gt;è¿™ä¸ªæ¥å£çš„ï¼Œé‚£ä¹ˆå¤„ç†ç”Ÿå‘½å‘¨æœŸçš„ä¸€äº›æ–¹æ³•è‚¯å®šåœ¨Activityä¸­å­˜åœ¨çš„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹&lt;em&gt;androidx.activity.ComponentActivity&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;open class ComponentActivity() :
    androidx.core.app.ComponentActivity(),
    ContextAware,
    LifecycleOwner {
    ...
    override fun onCreate(savedInstanceState: Bundle?) {
        savedStateRegistryController.performRestore(savedInstanceState)
        contextAwareHelper.dispatchOnContextAvailable(this)
        super.onCreate(savedInstanceState)
        ReportFragment.injectIfNeededIn(this)&#x2F;&#x2F; å…³é”®
        if (contentLayoutId != 0) {
            setContentView(contentLayoutId)
        }
    }

    @CallSuper
    override fun onSaveInstanceState(outState: Bundle) {
        if (lifecycle is LifecycleRegistry) {
            (lifecycle as LifecycleRegistry).currentState = Lifecycle.State.CREATED
        }
        super.onSaveInstanceState(outState)
        savedStateRegistryController.performSave(outState)
    }

    override val lifecycle: Lifecycle
        get() = super.lifecycle
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¥½åƒåªæ˜¯åœ¨&lt;code&gt;onSaveInstanceState&lt;&#x2F;code&gt;ä¸­è®¾ç½®äº†Lifecycleçš„Stateä¸ºCREATEDï¼Œè¿™æ˜¯å’‹å›äº‹ï¼Ÿå…¶ä»–çš„ç”Ÿå‘½å‘¨æœŸå‘¢ï¼Ÿå…¶å®æ˜¯åœ¨onCreateä¸­çš„&lt;code&gt;ReportFragment.injectIfNeededIn(this)&lt;&#x2F;code&gt;æ‰æ˜¯å…³é”®ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥ç‚¹è¿›å»ï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤šä¸œè¥¿çš„&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥æ…¢æ…¢çœ‹ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆä»&lt;code&gt;injectIfNeededIn&lt;&#x2F;code&gt;è¿™ä¸ªæ–¹æ³•çœ‹èµ·&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;        @JvmStatic
        fun injectIfNeededIn(activity: Activity) {
            &#x2F;&#x2F; å½“API 29 ä»¥ä¸Šç›´æ¥æ³¨å†Œå›è°ƒ
            if (Build.VERSION.SDK_INT &amp;gt;= 29) {
                LifecycleCallbacks.registerIn(activity)
            }
            val manager = activity.fragmentManager
            if (manager.findFragmentByTag(REPORT_FRAGMENT_TAG) == null) {
                manager.beginTransaction().add(ReportFragment(), REPORT_FRAGMENT_TAG).commit()
                manager.executePendingTransactions()
            }
        }
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•æ˜¯åˆ†äº†ç‰ˆæœ¬çš„ï¼ŒAPI 29ä¹‹å‰æ˜¯æ·»åŠ äº†ä¸€ä¸ª&lt;code&gt;ReportFragment()&lt;&#x2F;code&gt;ç»™å½“å‰Activityï¼Œä¹‹åä½¿ç”¨äº†LifecycleCallbacksã€‚å’±ä»¬å…ˆæ¥çœ‹çœ‹è€ç‰ˆæœ¬çš„&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@Suppress(&amp;quot;DEPRECATION&amp;quot;)
@RestrictTo(RestrictTo.Scope.LIBRARY_GROUP_PREFIX)
open class ReportFragment() : android.app.Fragment() {

    override fun onActivityCreated(savedInstanceState: Bundle?) {
        super.onActivityCreated(savedInstanceState)
        dispatchCreate(processListener)
        dispatch(Lifecycle.Event.ON_CREATE)
    }

    override fun onStart() {
        super.onStart()
        dispatchStart(processListener)
        dispatch(Lifecycle.Event.ON_START)
    }

    override fun onResume() {
        super.onResume()
        dispatchResume(processListener)
        dispatch(Lifecycle.Event.ON_RESUME)
    }

    override fun onPause() {
        super.onPause()
        dispatch(Lifecycle.Event.ON_PAUSE)
    }

    override fun onStop() {
        super.onStop()
        dispatch(Lifecycle.Event.ON_STOP)
    }

    override fun onDestroy() {
        super.onDestroy()
        dispatch(Lifecycle.Event.ON_DESTROY)
        &#x2F;&#x2F; just want to be sure that we won&amp;#39;t leak reference to an activity
        processListener = null
    }

    private fun dispatch(event: Lifecycle.Event) {
        if (Build.VERSION.SDK_INT &amp;lt; 29) {
            &#x2F;&#x2F; Only dispatch events from ReportFragment on API levels prior
            &#x2F;&#x2F; to API 29. On API 29+, this is handled by the ActivityLifecycleCallbacks
            &#x2F;&#x2F; added in ReportFragment.injectIfNeededIn
            dispatch(activity, event)
        }
    }
 }
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œéƒ½åœ¨å½“å‰ç”Ÿå‘½å‘¨æœŸä¸­ç”¨åˆ°äº†&lt;code&gt;dispatch&lt;&#x2F;code&gt;æ–¹æ³•ï¼Œå½“ç”Ÿå‘½å‘¨æœŸè¢«è§¦å‘åï¼Œä¼šä¼ ä¸€ä¸ªå¯¹åº”çš„äº‹ä»¶ç»™å®ƒï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•é‡Œé¢åˆç”¨åˆ°äº†ä¸€ä¸ª&lt;code&gt;dispatch&lt;&#x2F;code&gt;æ–¹æ³•ï¼Œæˆ‘ä»¬åé¢å†æ¥çœ‹è¿™ä¸ªæ–¹æ³•ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹API 29ä»¥ä¸Šæ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@RequiresApi(29)
internal class LifecycleCallbacks : Application.ActivityLifecycleCallbacks {
    override fun onActivityCreated(
        activity: Activity,
        bundle: Bundle?
    ) {}

    override fun onActivityPostCreated(
        activity: Activity,
        savedInstanceState: Bundle?
    ) {
        dispatch(activity, Lifecycle.Event.ON_CREATE)
    }

    override fun onActivityStarted(activity: Activity) {}

    override fun onActivityPostStarted(activity: Activity) {
        dispatch(activity, Lifecycle.Event.ON_START)
    }

    override fun onActivityResumed(activity: Activity) {}

    override fun onActivityPostResumed(activity: Activity) {
        dispatch(activity, Lifecycle.Event.ON_RESUME)
    }

    override fun onActivityPrePaused(activity: Activity) {
        dispatch(activity, Lifecycle.Event.ON_PAUSE)
    }

    override fun onActivityPaused(activity: Activity) {}

    override fun onActivityPreStopped(activity: Activity) {
        dispatch(activity, Lifecycle.Event.ON_STOP)
    }

    override fun onActivityStopped(activity: Activity) {}

    override fun onActivitySaveInstanceState(
        activity: Activity,
        bundle: Bundle
    ) {}

    override fun onActivityPreDestroyed(activity: Activity) {
        dispatch(activity, Lifecycle.Event.ON_DESTROY)
    }

    override fun onActivityDestroyed(activity: Activity) {}

    companion object {
        @JvmStatic
        fun registerIn(activity: Activity) {
            activity.registerActivityLifecycleCallbacks(LifecycleCallbacks())
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒAPI 29ä»¥ä¸ŠåŒæ ·ä¹Ÿæ˜¯ç”¨åˆ°äº†&lt;code&gt;dispacth&lt;&#x2F;code&gt;æ–¹æ³•ï¼Œåªä¸è¿‡å®ƒæ˜¯ç›´æ¥ä½¿ç”¨activityçš„registerActivityLifecycleCallbacks ç›´æ¥æ³¨å†Œäº†ç”Ÿå‘½å‘¨æœŸå›è°ƒï¼Œç„¶åç»™å½“å‰Activityæ·»åŠ ReportFragmentã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹dispatchè¿™ä¸ªæ–¹æ³•&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@JvmStatic
internal fun dispatch(activity: Activity, event: Lifecycle.Event) {
    if (activity is LifecycleRegistryOwner) {
        activity.lifecycle.handleLifecycleEvent(event)
        return
    }
    if (activity is LifecycleOwner) {
        val lifecycle = (activity as LifecycleOwner).lifecycle
        if (lifecycle is LifecycleRegistry) {
            lifecycle.handleLifecycleEvent(event)
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å†…éƒ¨éƒ½æ˜¯ä½¿ç”¨åˆ°äº†&lt;code&gt;lifecycle.handleLifecycleEvent(event)&lt;&#x2F;code&gt;ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒã€‚&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;open fun handleLifecycleEvent(event: Event) {
    enforceMainThreadIfNeeded(&amp;quot;handleLifecycleEvent&amp;quot;)
    &#x2F;&#x2F; å¼€å§‹å¯¹å½“å‰äº‹åŠ¡å‘ç”Ÿåçš„Stateåšå¤„ç†
    moveToState(event.targetState)
}

private fun moveToState(next: State) {
    &#x2F;&#x2F; å¦‚æœå½“å‰Stateä¸å³å°†è¦å‘ç”Ÿå˜åŒ–çš„Stateä¸€æ ·ï¼Œç›´æ¥è¿”å›
    if (state == next) {
        return
    }
    check(!(state == State.INITIALIZED &amp;amp;&amp;amp; next == State.DESTROYED)) {
        &amp;quot;no event down from $state in component ${lifecycleOwner.get()}&amp;quot;
    }
    &#x2F;&#x2F; èµ‹å€¼æ–°State
    state = next
    if (handlingEvent || addingObserverCounter != 0) {
        newEventOccurred = true
        &#x2F;&#x2F; we will figure out what to do on upper level.
        return
    }
    handlingEvent = true
    &#x2F;&#x2F; æŠŠæ–°çš„StateåŒæ­¥ç»™æ‰€æœ‰çš„è§‚å¯Ÿè€…
    sync()
    handlingEvent = false
    if (state == State.DESTROYED) {
        observerMap = FastSafeIterableMap()
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;è¿™é‡Œåº”è¯¥æ¯”è¾ƒå¥½ç†è§£ï¼Œå°±æ˜¯é‚£è¾¹ä¼ äº†ä¸€ä¸ªäº‹åŠ¡è¿‡æ¥ï¼Œæˆ‘ä»¬å»æ”¹å˜å½“å‰Stateï¼Œç›¸åŒè¿”å›ï¼Œä¸ä¸€æ ·å°±è¦åŒæ­¥ç»™æ‰€æœ‰çš„è§‚å¯Ÿè€…ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥çœ‹çœ‹syncè¿™ä¸ªæ–¹æ³•&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;private val isSynced: Boolean
    get() {
        &#x2F;&#x2F; observerMapå°±æ˜¯ åœ¨activityä¸­æ·»åŠ observerå ç”¨äºå­˜æ”¾observerçš„map
        if (observerMap.size() == 0) {
            return true
        }
        val eldestObserverState = observerMap.eldest()!!.value.state
        val newestObserverState = observerMap.newest()!!.value.state
        return eldestObserverState == newestObserverState &amp;amp;&amp;amp; state == newestObserverState
    }

private fun sync() {
    val lifecycleOwner = lifecycleOwner.get()
        ?: throw IllegalStateException(
            &amp;quot;LifecycleOwner of this LifecycleRegistry is already &amp;quot; +
                &amp;quot;garbage collected. It is too late to change lifecycle state.&amp;quot;
        )
    &#x2F;&#x2F; ä¸€ä¸ªå¾ªç¯ï¼ŒisSyncedè¡¨ç¤ºæ˜¯å¦åŒæ­¥ç»™äº†æ‰€æœ‰è§‚å¯Ÿè€…
    while (!isSynced) {
        newEventOccurred = false
        if (state &amp;lt; observerMap.eldest()!!.value.state) {
            backwardPass(lifecycleOwner)
        }
        val newest = observerMap.newest()
        if (!newEventOccurred &amp;amp;&amp;amp; newest != null &amp;amp;&amp;amp; state &amp;gt; newest.value.state) {
            forwardPass(lifecycleOwner)
        }
    }
    newEventOccurred = false
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œsyncå°±æ˜¯ç”¨æ¥åŒæ­¥æ‰€æœ‰çš„observerMapä¸­çš„è§‚å¯Ÿè€…ï¼Œé‚£è§‚å¯Ÿè€…æ˜¯æ€ä¹ˆè¢«åŠ è¿›æ¥çš„å‘¢ï¼Ÿç­”æ¡ˆè‡ªç„¶æ˜¯æˆ‘ä»¬åœ¨Activityä¸­ä½¿ç”¨çš„&lt;code&gt;addObserver()&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;override fun addObserver(observer: LifecycleObserver) {
    enforceMainThreadIfNeeded(&amp;quot;addObserver&amp;quot;)
    val initialState = if (state == State.DESTROYED) State.DESTROYED else State.INITIALIZED
    &#x2F;&#x2F; è¿™è¾¹ç”¨äº†ä¸€ä¸ªObserverWithStateæ¥ç®¡ç†observerçš„çŠ¶æ€
    val statefulObserver = ObserverWithState(observer, initialState)
    &#x2F;&#x2F; æ·»åŠ è§‚å¯Ÿè€…ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›nullï¼Œå­˜åœ¨ï¼Œè¿”å›å·²ç»å­˜åœ¨çš„å€¼
    val previous = observerMap.putIfAbsent(observer, statefulObserver)
    &#x2F;&#x2F; å¦‚æœå­˜åœ¨ï¼Œç›´æ¥è¿”å›ï¼Œé¿å…é‡å¤æ·»åŠ 
    if (previous != null) {
        return
    }
    val lifecycleOwner = lifecycleOwner.get()
        ?: &#x2F;&#x2F; it is null we should be destroyed. Fallback quickly
        return
    &#x2F;&#x2F; ä¸‹é¢ä»£ç çš„é€»è¾‘ï¼šé€šè¿‡whileå¾ªç¯ï¼ŒæŠŠæ–°çš„è§‚å¯Ÿè€…çš„çŠ¶æ€ è¿ç»­åœ° åŒæ­¥åˆ°æœ€æ–°çŠ¶æ€
    val isReentrance = addingObserverCounter != 0 || handlingEvent
    var targetState = calculateTargetState(observer)
    addingObserverCounter++
    while (statefulObserver.state &amp;lt; targetState &amp;amp;&amp;amp; observerMap.contains(observer)) {
        pushParentState(statefulObserver.state)
        val event = Event.upFrom(statefulObserver.state)
            ?: throw IllegalStateException(&amp;quot;no event up from ${statefulObserver.state}&amp;quot;)
        statefulObserver.dispatchEvent(lifecycleOwner, event)
        popParentState()
        &#x2F;&#x2F; mState &#x2F; subling may have been changed recalculate
        targetState = calculateTargetState(observer)
    }
    &#x2F;&#x2F; è¿™é‡Œå¦‚æœä¸æ˜¯åµŒå¥—çš„æ·»åŠ ï¼Œæˆ‘ä»¬å°±åˆè°ƒç”¨syncè¿™ä¸ªæ–¹æ³•
    if (!isReentrance) {
        &#x2F;&#x2F; we do sync only on the top level.
        sync()
    }
    addingObserverCounter--
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘ä»¬æ˜¯åœ¨onCreateé‡Œé¢æ·»åŠ è§‚å¯Ÿè€…çš„ï¼Œé‚£ä½ æœ‰æ²¡æœ‰æƒ³è¿‡å¦‚æœæˆ‘åœ¨onStartï¼ŒonResumeä¸­å»æ·»åŠ è§‚å¯Ÿè€…å¯ä¸å¯ä»¥å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œå‡å¦‚ä½ åœ¨onResumeä¸­æ·»åŠ ï¼Œé‚£ä»–ä¼šä¸ä¼šå›è°ƒonCreateï¼ŒonStarté‡Œé¢çš„æ–¹æ³•å‘¢ï¼Œæ˜¯ä¼šçš„ï¼Œå…³é”®å°±åœ¨äº&lt;code&gt;statefulObserver.dispatchEvent(lifecycleOwner, event)&lt;&#x2F;code&gt;ï¼Œæˆ‘ä»¬ç‚¹è¿›å»çœ‹çœ‹&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;internal class ObserverWithState(observer: LifecycleObserver?, initialState: State) {
    var state: State
    var lifecycleObserver: LifecycleEventObserver

    init {
        lifecycleObserver = Lifecycling.lifecycleEventObserver(observer!!)
        state = initialState
    }

    fun dispatchEvent(owner: LifecycleOwner?, event: Event) {
        val newState = event.targetState
        state = min(state, newState)
        lifecycleObserver.onStateChanged(owner!!, event)
        state = newState
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æœ‰æ²¡æœ‰å¯¹&lt;code&gt;LifecycleEventObserver&lt;&#x2F;code&gt;è¿™ä¸ªç±»æœ‰ç‚¹ç†Ÿæ‚‰ï¼Œæˆ‘ä»¬çš„MyObserver2æ˜¯ä¸æ˜¯å®ç°äº†è¿™ä¸ªæ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œå°±æ˜¯å°†æˆ‘ä»¬è‡ªå·±å†™çš„è§‚å¯Ÿè€…ä¼ äº†è¿›æ¥ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å¥½ï¼Œè¿™é‡ŒçŸ¥é“äº†è¿™ä¸ªå¾ªç¯çš„ä½œç”¨ï¼Œæˆ‘ä»¬åœ¨æ¥çœ‹çœ‹syncè¿™ä¸ªæ–¹æ³•æ˜¯å’‹åŒæ­¥observerçš„Stateçš„ï¼Œ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;private fun sync() {
    val lifecycleOwner = lifecycleOwner.get()
        ?: throw IllegalStateException(
            &amp;quot;LifecycleOwner of this LifecycleRegistry is already &amp;quot; +
                &amp;quot;garbage collected. It is too late to change lifecycle state.&amp;quot;
        )
    &#x2F;&#x2F; ä¸€ä¸ªå¾ªç¯ï¼ŒisSyncedè¡¨ç¤ºæ˜¯å¦åŒæ­¥ç»™äº†æ‰€æœ‰è§‚å¯Ÿè€…
    while (!isSynced) {
        newEventOccurred = false
        if (state &amp;lt; observerMap.eldest()!!.value.state) {
            backwardPass(lifecycleOwner)
        }
        val newest = observerMap.newest()
        if (!newEventOccurred &amp;amp;&amp;amp; newest != null &amp;amp;&amp;amp; state &amp;gt; newest.value.state) {
            forwardPass(lifecycleOwner)
        }
    }
    newEventOccurred = false
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°åœ¨è¿™ä¸ªå¾ªç¯ä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•&lt;code&gt;backwardPass(lifecycleOwner)&lt;&#x2F;code&gt;å’Œ&lt;code&gt;forwardPass(lifecycleOwner)&lt;&#x2F;code&gt;ï¼Œå…¶å®è¿™ä¸¤ä¸ªæ–¹æ³•å·®ä¸å¤šï¼Œå°±æ˜¯åˆ¤æ–­è¯¥è§‚å¯Ÿè€…çš„Stateä¸å½“å‰çš„Stateè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå°äºï¼Œå³è®©å…¶ç”Ÿå‘½å‘¨æœŸå¾€å‰èµ°ï¼ˆonCreate â€”&amp;gt; onStartï¼‰ï¼Œå¦åˆ™ï¼Œå¾€åã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å¾€åèµ°çš„&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;private fun backwardPass(lifecycleOwner: LifecycleOwner) {
    val descendingIterator = observerMap.descendingIterator()
    while (descendingIterator.hasNext() &amp;amp;&amp;amp; !newEventOccurred) {
        val (key, observer) = descendingIterator.next()
        while (observer.state &amp;gt; state &amp;amp;&amp;amp; !newEventOccurred &amp;amp;&amp;amp; observerMap.contains(key)
        ) {
            val event = Event.downFrom(observer.state)
                ?: throw IllegalStateException(&amp;quot;no event down from ${observer.state}&amp;quot;)
            pushParentState(event.targetState)
            observer.dispatchEvent(lifecycleOwner, event)
            popParentState()
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™é‡Œè¿˜æ˜¯è°ƒç”¨äº†&lt;code&gt;observer.dispatchEvent(lifecycleOwner, event)&lt;&#x2F;code&gt;è¿™ä¸ªæ–¹æ³•å»åŒæ­¥ï¼Œå¹¶ä¸”ä¹‹å‰ï¼Œå¾—åˆ°äº†ä¸€ä¸ªäº‹ä»¶&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@JvmStatic
public fun downFrom(state: State): Event? {
    return when (state) {
        State.CREATED -&amp;gt; ON_DESTROY
        State.STARTED -&amp;gt; ON_STOP
        State.RESUMED -&amp;gt; ON_PAUSE
        else -&amp;gt; null
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ç½‘ä¸Šæœ‰å¼ å›¾ï¼Œæè¿°äº†äº‹ä»¶ä¸çŠ¶æ€çš„å˜åŒ–&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;4.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h1 id=&quot;livedata&quot;&gt;LiveData&lt;&#x2F;h1&gt;
&lt;h2 id=&quot;shen-me-shi-livedata&quot;&gt;ä»€ä¹ˆæ˜¯LiveDataï¼Ÿ&lt;&#x2F;h2&gt;
&lt;p&gt;å®˜æ–¹å®šä¹‰ï¼š&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a rel=&quot;external&quot; href=&quot;https:&#x2F;&#x2F;developer.android.com&#x2F;reference&#x2F;android&#x2F;arch&#x2F;lifecycle&#x2F;LiveData&quot;&gt;LiveData &lt;&#x2F;a&gt;æ˜¯ä¸€ç§å¯è§‚å¯Ÿçš„æ•°æ®å­˜å‚¨å™¨ç±»ã€‚ä¸å¸¸è§„çš„å¯è§‚å¯Ÿç±»ä¸åŒï¼ŒLiveData å…·æœ‰ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥èƒ½åŠ›ï¼Œæ„æŒ‡å®ƒéµå¾ªå…¶ä»–åº”ç”¨ç»„ä»¶ï¼ˆå¦‚ Activity&#x2F;Fragmentï¼‰çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™ç§æ„ŸçŸ¥èƒ½åŠ›å¯ç¡®ä¿ LiveData ä»…æ›´æ–°å¤„äºæ´»è·ƒç”Ÿå‘½å‘¨æœŸçŠ¶æ€çš„åº”ç”¨ç»„ä»¶è§‚å¯Ÿè€…ã€‚&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;p&gt;ç®€å•æ¥è¯´ï¼ŒLiveDataå°±æ˜¯ä¸€ä¸ªæ•°æ®çš„æŒæœ‰è€…ï¼Œæ•°æ®è¢«åŒ…è£…åï¼Œå¯ä»¥è¢«observerè§‚å¯Ÿï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ˜¯observerå¯ä»¥æ„ŸçŸ¥åˆ°ï¼Œä½†è¿™ç§æ„ŸçŸ¥ï¼Œåªä¼šå‘ç”Ÿåœ¨&lt;strong&gt;LifecycleOwnerçš„æ´»è·ƒç”Ÿå‘½å‘¨æœŸçŠ¶æ€ï¼ˆSTARTED,RESUMEDï¼‰&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;livedatade-hao-chu&quot;&gt;LiveDataçš„å¥½å¤„&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;ç¡®ä¿UIä¸æ•°æ®çŠ¶æ€åŒ¹é…&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;å½“æˆ‘ä»¬çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥é€šçŸ¥åˆ°UIæ›´æ–°&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…å†…å­˜æ³„æ¼&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;è§‚å¯Ÿè€…ç»‘å®šåˆ°lifecycleå¯¹è±¡ä¸Šï¼Œå½“ä¸ä¹‹ç»‘å®šçš„lifecycleé”€æ¯æ—¶ï¼Œä»–ä»¬ä¼šè‡ªåŠ¨è¢«æ¸…ç†&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ä¼šç»™å·²ç»åœæ­¢çš„Activityå‘é€æ¶ˆæ¯&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;å½“æ‰€ç»‘å®šçš„lifecycleå¤„äºéæ´»è·ƒçŠ¶æ€æ—¶ï¼Œæ¯”å¦‚å¤„äºæ ˆä¸­çš„Activityï¼Œä¸ä¼šå—åˆ°ä»»ä½•LiveDataçš„æ¶ˆæ¯&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸éœ€è¦æ‰‹åŠ¨å¤„ç†ç”Ÿå‘½å‘¨æœŸ&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;LiveDataå…·å¤‡ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥èƒ½åŠ›ï¼ŒUIåªéœ€å¯¹ç›¸å…³çš„æ•°æ®è¿›è¡Œç›‘å¬&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;ç³»ç»Ÿé…ç½®æ›´æ”¹æ—¶ï¼Œè¿›è¡Œæ•°æ®çš„ä¿å­˜å’Œæ¢å¤ï¼ŒåŠ UI çš„æ¢å¤&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;å½“Activityä¸Fragmentå‘ç”Ÿé…ç½®æ›´æ”¹è€Œé‡æ–°æ„å»ºæ—¶ï¼ˆå¦‚ï¼Œæ—‹è½¬æ‰‹æœºå±å¹•ï¼‰ï¼Œä¼šæ”¶åˆ°æœ€æ–°çš„æ¶ˆæ¯&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;èµ„æºå…±äº«&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ç”¨å•ä¾‹æ¨¡å¼æ¥æ‰©å±•LiveDataï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°±ä¼šé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…&lt;&#x2F;p&gt;
&lt;h2 id=&quot;livedatade-yong-fa&quot;&gt;LiveDataçš„ç”¨æ³•&lt;&#x2F;h2&gt;
&lt;p&gt;LiveDataæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚é€šå¸¸æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å®ƒçš„ç›´æ¥å­ç±»&lt;code&gt;MutableLiveData&lt;&#x2F;code&gt;ã€‚&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;class LiveDataActivity: AppCompatActivity() {

    private val mLiveData = MutableLiveData&amp;lt;String&amp;gt;()
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_livedata)
        val mTextView: TextView = findViewById(R.id.textView)
        val button: Button = findViewById(R.id.button)
        button.setOnClickListener {
            mLiveData.value = &amp;quot;å€¼è¢«æ”¹å˜äº†&amp;quot;
        }
        mLiveData.observe(this) {
            mTextView.text = it
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œç”¨æ³•è¿˜æ˜¯æŒºç®€å•çš„ï¼Œå…ˆå®šä¹‰äº†ä¸€ä¸ªMutableLiveDataå¯¹è±¡mLiveDataï¼Œç„¶åå»æ”¹å˜é‡Œé¢æ‰€åŒ…è£…çš„æ•°æ®ï¼Œæ€ä¹ˆæ”¹å˜çš„å‘¢ï¼Ÿæä¾›äº†ä¸¤ç§æ–¹æ³•ï¼Œ&lt;code&gt;setValue&lt;&#x2F;code&gt;å’Œ&lt;code&gt;postValue&lt;&#x2F;code&gt;ï¼ˆå­çº¿ç¨‹ä½¿ç”¨ï¼‰ï¼Œç„¶åæˆ‘ä»¬åé¢è§‚å¯Ÿï¼Œä¼ å…¥çš„æ˜¯æ‹¥æœ‰ç”Ÿå‘½å‘¨æœŸçš„ç»„ä»¶ï¼Œè¿˜æœ‰ä¸€ä¸ªå½“æ”¶åˆ°æ•°æ®ä¹‹åçš„å›è°ƒï¼Œæˆ‘ä»¬è¿™é‡Œå°†TextViewçš„æ–‡æœ¬è¿›è¡Œæ”¹å˜ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;livedatade-yuan-li&quot;&gt;LiveDataçš„åŸç†&lt;&#x2F;h2&gt;
&lt;p&gt;è·ŸLifecycleä¸€æ ·æˆ‘ä»¬ä»observeè¿™ä¸ªæ–¹æ³•çœ‹èµ·ï¼Œ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;java&quot;&gt;@MainThread
public void observe(@NonNull LifecycleOwner owner, @NonNull Observer&amp;lt;? super T&amp;gt; observer) {
    assertMainThread(&amp;quot;observe&amp;quot;);
    if (owner.getLifecycle().getCurrentState() == DESTROYED) {
        &#x2F;&#x2F; ignore
        return;
    }
    LifecycleBoundObserver wrapper = new LifecycleBoundObserver(owner, observer);
    ObserverWrapper existing = mObservers.putIfAbsent(observer, wrapper);
    if (existing != null &amp;amp;&amp;amp; !existing.isAttachedTo(owner)) {
        throw new IllegalArgumentException(&amp;quot;Cannot add the same observer&amp;quot;
                + &amp;quot; with different lifecycles&amp;quot;);
    }
    if (existing != null) {
        return;
    }
    owner.getLifecycle().addObserver(wrapper);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œå½“LifecycleOwnerçš„çŠ¶æ€ä¸ºDESTROYEDæ—¶ï¼Œç›´æ¥è¿”å›ï¼Œç„¶åç”¨æˆ‘ä»¬å‘¢ä¼ è¿›æ¥çš„ownerå’Œobserverç»„è£…æˆäº†ä¸€ä¸ªæ–°çš„ç±»LifecycleBoundObserverï¼Œç„¶åä½¿ç”¨putIfAbsentæ–¹æ³•observer-wrapperä½œä¸ºkey-valueæ·»åŠ åˆ°è§‚å¯Ÿè€…åˆ—è¡¨mObserversä¸­ã€‚ï¼ˆputIfAbsentæ„æ€æ˜¯åªæœ‰åˆ—è¡¨ä¸­æ²¡æœ‰è¿™ä¸ªobserveræ—¶æ‰ä¼šæ·»åŠ ï¼‰ï¼Œæœ€åç”¨LifecycleOwnerçš„Lifecycleæ·»åŠ observerçš„å°è£…wrapper&lt;&#x2F;p&gt;
&lt;p&gt;æ—¢ç„¶æˆ‘ä»¬æœ€åæ˜¯ç”¨Lifecycleå°†æˆ‘ä»¬çš„è§‚å¯Ÿè€…wrapperåŠ è¿›å»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥çœ‹çœ‹LifecycleBoundObserverç±»&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;java&quot;&gt;class LifecycleBoundObserver extends ObserverWrapper implements LifecycleEventObserver {
    @NonNull
    final LifecycleOwner mOwner;

    LifecycleBoundObserver(@NonNull LifecycleOwner owner, Observer&amp;lt;? super T&amp;gt; observer) {
        super(observer);
        mOwner = owner;
    }

    &#x2F;&#x2F; STARTEDçŠ¶æ€æˆ–è€…RESUMEçŠ¶æ€
    @Override
    boolean shouldBeActive() {
        return mOwner.getLifecycle().getCurrentState().isAtLeast(STARTED);
    }

    @Override
    public void onStateChanged(@NonNull LifecycleOwner source,
            @NonNull Lifecycle.Event event) {
        Lifecycle.State currentState = mOwner.getLifecycle().getCurrentState();
        &#x2F;&#x2F; å½“å½“å‰çŠ¶æ€ä¸ºDESTROYEDæ—¶ï¼Œç§»é™¤è§‚å¯Ÿè€…
        if (currentState == DESTROYED) {
            removeObserver(mObserver);
            return;
        }
        Lifecycle.State prevState = null;
        while (prevState != currentState) {
            prevState = currentState;
            activeStateChanged(shouldBeActive());
            currentState = mOwner.getLifecycle().getCurrentState();
        }
    }

    @Override
    boolean isAttachedTo(LifecycleOwner owner) {
        return mOwner == owner;
    }

    @Override
    void detachObserver() {
        mOwner.getLifecycle().removeObserver(this);
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å®ƒå®ç°äº†LifecycleEventObserveræ¥å£ï¼Œå¹¶ä¸”é‡å†™äº†onStateChangedè¿™ä¸ªæ–¹æ³•ã€‚å½“çŠ¶æ€ä¸ºDESTROYEDæ—¶ï¼Œä¼šè‡ªåŠ¨ç§»é™¤è§‚å¯Ÿè€…ï¼Œæ•…è€Œé¿å…å†…å­˜æ³„æ¼ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä¼šè°ƒç”¨ObserverWrapperä¸­çš„&lt;code&gt;activeStateChanged(shouldBeActive())&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Java&quot;&gt;void activeStateChanged(boolean newActive) {
    if (newActive == mActive) {
        return;
    }
    &#x2F;&#x2F; immediately set active state, so we&amp;#39;d never dispatch anything to inactive
    &#x2F;&#x2F; owner
    mActive = newActive;
    changeActiveCounter(mActive ? 1 : -1);
    if (mActive) {
        dispatchingValue(this);
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;mActiveæ˜¯ObserverWrapperçš„å±æ€§ï¼Œè¡¨ç¤ºæ­¤è§‚å¯Ÿè€…æ˜¯å¦æ´»è·ƒï¼Œé»˜è®¤æ˜¯falseã€‚æ‰€ä»¥ï¼Œå¦‚æœnewActiveä¹Ÿæ˜¯falseå°±ä¸ä¼šå»å¤„ç†äº†ï¼Œå¦‚æœæ˜¯æ´»è·ƒçš„ï¼Œå°±ä¼šå»å‡ºå‘changeActiveCounter(mActive ? 1 : -1)æ–¹æ³•ï¼Œç”¨æ¥æ”¹å˜LiveDataä¸­çš„mActiveCountï¼ˆå½“å‰æ´»è·ƒè§‚å¯Ÿè€…æ•°é‡çš„è®¡æ•°å™¨ï¼‰ï¼Œæˆ‘ä»¬ä¸»è¦çœ‹&lt;code&gt;dispatchingValue(this)&lt;&#x2F;code&gt;è¿™ä¸ªæ–¹æ³•&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Java&quot;&gt;@SuppressWarnings(&amp;quot;WeakerAccess&amp;quot;) &#x2F;* synthetic access *&#x2F;
void dispatchingValue(@Nullable ObserverWrapper initiator) {
    &#x2F;&#x2F; å¦‚æœäº‹ä»¶æ­£åœ¨åˆ†å‘ï¼Œåˆ™è¿™æ¬¡åˆ†å‘æ²¡æœ‰ç”¨ï¼Œåˆ™è¿”å›
    if (mDispatchingValue) {
        mDispatchInvalidated = true;
        return;
    }
    &#x2F;&#x2F; è¡¨ç¤ºæ­£åœ¨åˆ†å‘
    mDispatchingValue = true;
    do {
        mDispatchInvalidated = false;
        if (initiator != null) {
            considerNotify(initiator);
            initiator = null;
        } else {
            for (Iterator&amp;lt;Map.Entry&amp;lt;Observer&amp;lt;? super T&amp;gt;, ObserverWrapper&amp;gt;&amp;gt; iterator =
                    mObservers.iteratorWithAdditions(); iterator.hasNext(); ) {
                considerNotify(iterator.next().getValue());
                if (mDispatchInvalidated) {
                    break;
                }
            }
        }
    } while (mDispatchInvalidated);
    mDispatchingValue = false;
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;è¿™é‡Œå­˜åœ¨ä¸¤ä¸ªbooleanå˜é‡ï¼Œ&lt;code&gt;mDispatchingValue&lt;&#x2F;code&gt;å’Œ&lt;code&gt;mDispatchInvalidated&lt;&#x2F;code&gt;ï¼Œä¸€ä¸ªç”¨æ¥æ ‡è®°å½“å‰æ˜¯å¦åœ¨åˆ†å‘äº‹ä»¶ï¼Œä¸€ä¸ªè¡¨ç¤ºå½“å‰åˆ†å‘å·²ç»æ— æ•ˆï¼Œä¸‹æ¬¡éœ€è¦é‡æ–°åˆ†å‘ï¼Œç„¶åï¼Œå½“æˆ‘ä»¬ä¼ è¿›æ¥çš„initiatorä¸ä¸ºç©ºæ—¶ï¼Œå°±ä¼šå»ä¸“é—¨é€šçŸ¥è¿™ä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œè°ƒç”¨&lt;code&gt;considerNotify(initiator)&lt;&#x2F;code&gt;è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚æœä¸ºç©ºåˆ™ä¼šå»ç”¨ä¸€ä¸ªå¾ªç¯å»é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆå¯ä»¥ä¸ºç©ºï¼Œæˆ‘ä»¬å…ˆä¸è°ˆï¼Œå’±ä»¬å…ˆæ¥çœ‹çœ‹&lt;code&gt;considerNotify(initiator)&lt;&#x2F;code&gt;è¿™ä¸ªæ–¹æ³•ã€‚&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Java&quot;&gt;@SuppressWarnings(&amp;quot;unchecked&amp;quot;)
private void considerNotify(ObserverWrapper observer) {
    if (!observer.mActive) {
        return;
    }
    &#x2F;&#x2F; Check latest state b4 dispatch. Maybe it changed state but we didn&amp;#39;t get the event yet.
    &#x2F;&#x2F;
    &#x2F;&#x2F; we still first check observer.active to keep it as the entrance for events. So even if
    &#x2F;&#x2F; the observer moved to an active state, if we&amp;#39;ve not received that event, we better not
    &#x2F;&#x2F; notify for a more predictable notification order.
    if (!observer.shouldBeActive()) {
        observer.activeStateChanged(false);
        return;
    }
    if (observer.mLastVersion &amp;gt;= mVersion) {
        return;
    }
    observer.mLastVersion = mVersion;
    observer.mObserver.onChanged((T) mData);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å…ˆè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœå½“å‰è§‚å¯Ÿè€…ä¸æ˜¯æ´»è·ƒçŠ¶æ€è¿”å›ï¼Œå¦åˆ™ä¼šå†æ¬¡ä¼šæ£€æµ‹ä¸€ä¸‹è§‚å¯Ÿè€…å¯¹åº”çš„ownerï¼Œçœ‹å…¶æ˜¯å¦æ˜¯æ´»è·ƒçŠ¶æ€ï¼Œå¦‚æœä¸æ˜¯ï¼Œå†æ¬¡è°ƒç”¨activeStateChangedæ–¹æ³•ï¼Œå¹¶ä¼ å…¥falseï¼Œå…¶å†…éƒ¨ä¼šå†æ¬¡åˆ¤æ–­ã€‚ç„¶åï¼Œåœ¨åˆ¤æ–­ç‰ˆæœ¬å·ï¼Œå¦‚æœobserveræ‰€æŒæœ‰çš„æœ€æ–°ç‰ˆæœ¬å·å¤§äºç­‰äºå½“å‰çš„ç‰ˆæœ¬ï¼Œåˆ™è¡¨ç¤ºæ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œä¸éœ€è¦åˆ†å‘äº†ï¼Œå¦åˆ™ï¼Œåˆ†å‘äº‹ä»¶ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;åˆ°è¿™é‡Œï¼Œé€»è¾‘åº”è¯¥é€šç•…äº†è®¸å¤šã€‚æˆ‘ä»¬ä¸Šé¢æåˆ°äº†ç‰ˆæœ¬å·ï¼Œè¿™æ˜¯åœ¨å“ªé‡Œæ”¹å˜çš„å‘¢ï¼Ÿç­”æ¡ˆå°±åœ¨setValueå’ŒpostValueä¸¤ä¸ªæ•°æ®æ›´æ–°çš„æ–¹æ³•é‡Œ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;java&quot;&gt;@MainThread
protected void setValue(T value) {
    assertMainThread(&amp;quot;setValue&amp;quot;);
    mVersion++;
    mData = value;
    dispatchingValue(null);
}

protected void postValue(T value) {
    boolean postTask;
    synchronized (mDataLock) {
        postTask = mPendingData == NOT_SET;
        mPendingData = value;
    }
    if (!postTask) {
        return;
    }
    &#x2F;&#x2F;æŠ›åˆ°ä¸»çº¿ç¨‹
    ArchTaskExecutor.getInstance().postToMainThread(mPostValueRunnable);
}
private final Runnable mPostValueRunnable = new Runnable() {
    @SuppressWarnings(&amp;quot;unchecked&amp;quot;)
    @Override
    public void run() {
        Object newValue;
        synchronized (mDataLock) {
            newValue = mPendingData;
            mPendingData = NOT_SET;
        }
        setValue((T) newValue);
    }
};
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°åœ¨setValueæ–¹æ³•ä¸­æœ‰ä¸€ä¸ª&lt;code&gt;mVersion++&lt;&#x2F;code&gt;ï¼Œç„¶åè°ƒç”¨äº†&lt;code&gt;dispatchingValue(null)&lt;&#x2F;code&gt;æ–¹æ³•ï¼ŒåŠä¸Šé¢æåˆ°çš„ç©ºçš„æƒ…å†µï¼Œæ‰€ä»¥ä¸€åˆ‡éƒ½æ˜äº†äº†ã€‚è€ŒpostValueä¸€æ ·æœ€åä¼šè°ƒç”¨setValueæ–¹æ³•ï¼Œåªä¸è¿‡å®ƒç”¨äºåœ¨å­çº¿ç¨‹ä¸­æ›´æ–°æ•°æ®ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;åˆ°è¿™ï¼Œå…³äºLiveDataçš„æºç åˆ†æå°±åˆ°è¿™ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯LivaDataé€šè¿‡observe()æ·»åŠ ä¸LifecycleOwnerç»‘å®šçš„è§‚å¯Ÿè€…ï¼›è§‚å¯Ÿè€…å˜ä¸ºæ´»è·ƒæ—¶å›è°ƒæœ€æ–°çš„æ•°æ®ï¼›ä½¿ç”¨setValue()ã€postValue()æ›´æ–°æ•°æ®æ—¶ä¼šé€šçŸ¥å›è°ƒæ‰€æœ‰çš„è§‚å¯Ÿè€…ã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;viewmodel&quot;&gt;ViewModel&lt;&#x2F;h1&gt;
&lt;h2 id=&quot;shen-me-shi-viewmodel&quot;&gt;ä»€ä¹ˆæ˜¯ViewModelï¼Ÿ&lt;&#x2F;h2&gt;
&lt;p&gt;ViewModelï¼Œæ„ä¸º è§†å›¾æ¨¡å‹ï¼Œå³ &lt;strong&gt;ä¸ºç•Œé¢å‡†å¤‡æ•°æ®çš„æ¨¡å‹&lt;&#x2F;strong&gt;ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ç®€å•ç†è§£å°±æ˜¯ï¼ŒViewModelæ˜¯ä¸€ä¸ªä¸ºUIå±‚æä¾›æ•°æ®çš„ä¸œè¥¿ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;viewmodelchu-xian-de-bei-jing&quot;&gt;ViewModelå‡ºç°çš„èƒŒæ™¯&lt;&#x2F;h2&gt;
&lt;p&gt;å½“æˆ‘ä»¬çš„activityæˆ–fragmentå‘ç”Ÿæ„å¤–é‡æ„äº†ï¼ˆå¦‚å±å¹•æ—‹è½¬ç­‰ï¼‰ï¼Œæˆ‘ä»¬æ•°æ®è¿˜ä¼šæœ‰å—ï¼Ÿ&lt;&#x2F;p&gt;
&lt;p&gt;ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œviewmodelå°±å‘æŒ¥å‡ºç”¨å¤„äº†ï¼ŒåŸå› å°±åœ¨äºviewmodelçš„ç”Ÿå‘½å‘¨æœŸæ¯”activityçš„æ›´é•¿ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;5.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;viewmodelde-shi-yong&quot;&gt;ViewModelçš„ä½¿ç”¨&lt;&#x2F;h2&gt;
&lt;h3 id=&quot;chuang-jian-viewmodel&quot;&gt;åˆ›å»ºViewModel&lt;&#x2F;h3&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;class TestViewmodel : ViewModel() {
    private val _data = MutableLiveData&amp;lt;String&amp;gt;()
    val data: LiveData&amp;lt;String&amp;gt;
        get() = _data

    fun getData() {
        _data.value = &amp;quot;è·å–åˆ°äº†æ•°æ®&amp;quot;
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä¸åº”è¯¥å°†MutableLiveDataæš´éœ²ç»™activityï¼Œè€Œæ˜¯åœ¨viewmodelé‡Œå»ä¿®æ”¹æ•°æ®ï¼Œç„¶åå°†å…¶è½¬åŒ–ä¸ºLiveDataä¼ ç»™activityã€‚&lt;&#x2F;p&gt;
&lt;h3 id=&quot;activityhuo-qu-viewmodel&quot;&gt;activityè·å–viewmodel&lt;&#x2F;h3&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;class ViewModelActivity : AppCompatActivity() {

    private val binding by lazy { ActivityViewmodelBinding.inflate(layoutInflater) }
    private val mViewModel by lazy {
        ViewModelProvider(this)[TestViewmodel::class.java]
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContentView(binding.root)
        binding.btn.setOnClickListener {
            mViewModel.getData()
        }
        &#x2F;&#x2F; è§‚å¯Ÿ
        mViewModel.data.observe(this) {
            binding.tv.text = it
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬ç”¨äº†ä¸ªViewModelProviderï¼Œä¼ äº†ä¸ªLifecycleownerè¿›å»ï¼Œç„¶åæŠŠæˆ‘ä»¬çš„ViewModelå†™äº†è¿›å»ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ç„¶åé€šè¿‡ç‚¹å‡»äº‹ä»¶ï¼Œæ‰§è¡Œæˆ‘ä»¬viewmodelé‡Œé¢çš„getDataæ–¹æ³•ï¼Œç„¶åè§‚å¯Ÿå®Œäº‹ï¼&lt;&#x2F;p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿˜æä¾›äº†å…¶ä»–çš„åˆ›å»ºæ–¹å¼&lt;&#x2F;p&gt;
&lt;p&gt;å¯¼å…¥ä¾èµ–&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;&#x2F;&#x2F; activity
implementation(&amp;quot;androidx.activity:activity-ktx:1.10.1&amp;quot;)
&#x2F;&#x2F; fragment
implementation(&amp;quot;androidx.fragment:fragment-ktx:1.8.6&amp;quot;)
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹å¼åˆ›å»º&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;private val mViewModel by viewModels&amp;lt;TestViewmodel&amp;gt;()
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;viewmodelde-yuan-li&quot;&gt;ViewModelçš„åŸç†&lt;&#x2F;h2&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆå½“activity&#x2F;fragmenté‡å»ºåï¼Œviewmodelè¿˜å¯ä»¥å­˜åœ¨å‘¢ï¼Ÿ&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä»¬ä»&lt;code&gt;ViewModelProvider(this)[TestViewmodel::class.java]&lt;&#x2F;code&gt;ä¸‹æ‰‹ï¼ŒViewModelProviderç”±åå¯çŸ¥Viewmodelçš„æä¾›è€…ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„æ„é€ æ–¹æ³•&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;public constructor(
    owner: ViewModelStoreOwner
) : this(owner.viewModelStore, defaultFactory(owner), defaultCreationExtras(owner))

public constructor(owner: ViewModelStoreOwner, factory: Factory) : this(
    owner.viewModelStore,
    factory,
    defaultCreationExtras(owner)
)
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä»‹ç»ä¸€ä¸‹å„ä¸ªç±»&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ViewModelStoreOwner&lt;&#x2F;code&gt;ï¼šViewModelå­˜å‚¨å™¨æ‹¥æœ‰è€…&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;ViewModelStore&lt;&#x2F;code&gt;ï¼šViewModelå­˜å‚¨å™¨&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;Factory&lt;&#x2F;code&gt;ï¼šåˆ›é€ ViewModelå®ä¾‹çš„å·¥å‚&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ViewModelStoreOwner:&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;interface ViewModelStoreOwner {

    &#x2F;**
     * The owned [ViewModelStore]
     *&#x2F;
    val viewModelStore: ViewModelStore
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å…¶æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬çš„Activityå’ŒFragmentéƒ½å®ç°äº†è¿™ä¸ªæ¥å£ï¼Œéƒ½æ˜¯ViewModelå­˜å‚¨å™¨æ‹¥æœ‰è€…ï¼Œæˆ‘ä»¬å…ˆä¸ç®¡ä»–ä»¬æ˜¯å’‹è·å–åˆ°ViewModelStoreçš„ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ViewModelStoreæ˜¯å’‹å­˜å‚¨Viewmodelçš„&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;open class ViewModelStore {

    private val map = mutableMapOf&amp;lt;String, ViewModel&amp;gt;()

    @RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)
    fun put(key: String, viewModel: ViewModel) {
        val oldViewModel = map.put(key, viewModel)
        oldViewModel?.onCleared()
    }

    @RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)
    operator fun get(key: String): ViewModel? {
        return map[key]
    }

    @RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)
    fun keys(): Set&amp;lt;String&amp;gt; {
        return HashSet(map.keys)
    }

    fun clear() {
        for (vm in map.values) {
            vm.clear()
        }
        map.clear()
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œå†…éƒ¨è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼ŒviewModelä½œä¸ºValueå­˜å‚¨åœ¨mapä¸­&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä»¬å†æ¥çœ‹çœ‹Factoryæ˜¯å’‹ç”Ÿäº§ViewModelçš„&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;public interface Factory {

    public fun &amp;lt;T : ViewModel&amp;gt; create(modelClass: Class&amp;lt;T&amp;gt;): T {
        throw UnsupportedOperationException(
            &amp;quot;Factory.create(String) is unsupported.  This Factory requires &amp;quot; +
                &amp;quot;`CreationExtras` to be passed into `create` method.&amp;quot;
        )
    }

    public fun &amp;lt;T : ViewModel&amp;gt; create(modelClass: Class&amp;lt;T&amp;gt;, extras: CreationExtras): T =
        create(modelClass)

    companion object {
        @JvmStatic
        fun from(vararg initializers: ViewModelInitializer&amp;lt;*&amp;gt;): Factory =
            InitializerViewModelFactory(*initializers)
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å®ƒæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€Œæˆ‘ä»¬çš„å®ç°ç±»æ˜¯&lt;code&gt;NewInstanceFactory&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@Suppress(&amp;quot;SingletonConstructor&amp;quot;)
public open class NewInstanceFactory : Factory {
    @Suppress(&amp;quot;DocumentExceptions&amp;quot;)
    override fun &amp;lt;T : ViewModel&amp;gt; create(modelClass: Class&amp;lt;T&amp;gt;): T {
        return try {
            modelClass.getDeclaredConstructor().newInstance()
        } catch (e: NoSuchMethodException) {
            throw RuntimeException(&amp;quot;Cannot create an instance of $modelClass&amp;quot;, e)
        } catch (e: InstantiationException) {
            throw RuntimeException(&amp;quot;Cannot create an instance of $modelClass&amp;quot;, e)
        } catch (e: IllegalAccessException) {
            throw RuntimeException(&amp;quot;Cannot create an instance of $modelClass&amp;quot;, e)
        }
    }
    ...
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;è¿™è¾¹åˆ©ç”¨äº†åå°„æœºåˆ¶ï¼Œå°†ä¼ å…¥çš„classé€šè¿‡åå°„è·å–Viewmodel.&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;åå°„æ˜¯ Java ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå®ƒå…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶è·å–è‡ªèº«çš„ä¿¡æ¯ï¼Œå¹¶åŠ¨æ€åœ°æ“ä½œç±»æˆ–å¯¹è±¡çš„å±æ€§ã€æ–¹æ³•å’Œæ„é€ å‡½æ•°ã€‚é€šè¿‡åå°„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨äº‹å…ˆä¸çŸ¥é“ç¡®åˆ‡ç±»åçš„æƒ…å†µä¸‹å®ä¾‹åŒ–å¯¹è±¡ã€è°ƒç”¨æ–¹æ³•å’Œè®¾ç½®å±æ€§ã€‚&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;p&gt;æˆ‘ä»¬å†æ¥çœ‹çœ‹&lt;code&gt;ViewModelProvider(this)[TestViewmodel::class.java]&lt;&#x2F;code&gt;çš„ä¸­æ‹¬å·æ˜¯ä»€ä¹ˆï¼Œå…¶å®æ˜¯ä¸€ä¸ªgetæ–¹æ³•ï¼Œè¿™é‡Œç”¨åˆ°äº†kotlinä¸­çš„è¯­æ³•ç³–ï¼Œé‡è½½äº† &lt;code&gt;operator fun get()&lt;&#x2F;code&gt;ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨ä¸­æ‹¬å·ä»£æ›¿getæ–¹æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªgetæ–¹æ³•&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@MainThread
public open operator fun &amp;lt;T : ViewModel&amp;gt; get(modelClass: Class&amp;lt;T&amp;gt;): T {
    val canonicalName = modelClass.canonicalName
        ?: throw IllegalArgumentException(&amp;quot;Local and anonymous classes can not be ViewModels&amp;quot;)
    return get(&amp;quot;$DEFAULT_KEY:$canonicalName&amp;quot;, modelClass)
}

@Suppress(&amp;quot;UNCHECKED_CAST&amp;quot;)
@MainThread
public open operator fun &amp;lt;T : ViewModel&amp;gt; get(key: String, modelClass: Class&amp;lt;T&amp;gt;): T {
    val viewModel = store[key]
    if (modelClass.isInstance(viewModel)) {
        (factory as? OnRequeryFactory)?.onRequery(viewModel!!)
        return viewModel as T
    } else {
        @Suppress(&amp;quot;ControlFlowWithEmptyBody&amp;quot;)
        if (viewModel != null) {
            &#x2F;&#x2F; TODO: log a warning.
        }
    }
    val extras = MutableCreationExtras(defaultCreationExtras)
    extras[VIEW_MODEL_KEY] = key
    &#x2F;&#x2F; AGP has some desugaring issues associated with compileOnly dependencies so we need to
    &#x2F;&#x2F; fall back to the other create method to keep from crashing.
    return try {
        factory.create(modelClass, extras)
    } catch (e: AbstractMethodError) {
        factory.create(modelClass)
    }.also { store.put(key, it) }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;åº”è¯¥æŒºå¥½çŸ¥é“çš„ï¼Œå°±æ˜¯å°†viewmodelä»æˆ‘ä»¬çš„ViewModelStoreä¸­å–å‡ºæ¥ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šå»ç”¨factoryåˆ›é€ å‡ºæ¥ï¼Œç„¶åå†å­˜å…¥storeé‡Œé¢ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;okï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“äº†Viewmodelæ˜¯æ€ä¹ˆè¢«å­˜å‚¨çš„ï¼Œæ€ä¹ˆè¢«åˆ›é€ çš„ï¼Œæ¥ä¸‹æ¥å°±æ¥èŠèŠæˆ‘ä»¬ä¸€å¼€å§‹çš„é‚£ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆviewmodelå†activity&#x2F;fragmentå¼‚å¸¸é‡å»ºåä¸ä¼šæ¶ˆå¤±ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥çœ‹çœ‹activity&#x2F;fragmentæ˜¯å’‹ä»è·å–åˆ°ViewmodelStoreï¼Œ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;override val viewModelStore: ViewModelStore
    get() {
        &#x2F;&#x2F; activityè¿˜æ²¡å…³è”Applicationï¼Œå³ä¸èƒ½åœ¨onCreateä¹‹å‰å»è·å–viewModel
        checkNotNull(application) {
            (&amp;quot;Your activity is not yet attached to the &amp;quot; +
                &amp;quot;Application instance. You can&amp;#39;t request ViewModel before onCreate call.&amp;quot;)
        }
        ensureViewModelStore()
        return _viewModelStore!!
    }

private fun ensureViewModelStore() {
    if (_viewModelStore == null) {
        val nc = lastNonConfigurationInstance as NonConfigurationInstances?
        if (nc != null) {
            &#x2F;&#x2F; Restore the ViewModelStore from NonConfigurationInstances
            _viewModelStore = nc.viewModelStore
        }
        if (_viewModelStore == null) {
            _viewModelStore = ViewModelStore()
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å¦‚æœ_viewModelStoreä¸ºç©ºçš„è¯ï¼Œä¼šä»NonConfigurationInstanceä¸­è·å–æˆ‘ä»¬çš„viewModelStoreï¼Œå¦‚æœå®ƒé‡Œé¢æ²¡æœ‰ï¼Œå°±ä¼šé‡æ–°å®šä¹‰ä¸€ä¸ªViewModelStoreï¼Œé‚£è¿™ä¸ªNonConfigurationInstanceæ˜¯ä¸ªå•¥å‘¢ï¼Ÿç¿»è¯‘è¿‡æ¥:&lt;strong&gt;éé…ç½®å®ä¾‹&lt;&#x2F;strong&gt;,å³ä¸ç³»ç»Ÿé…ç½®æ— å…³çš„å®ä¾‹ã€‚æ‰€ä»¥å±å¹•æ—‹è½¬ç­‰çš„é…ç½®æ”¹å˜ä¸ä¼šå½±å“åˆ°è¿™ä¸ªå®ä¾‹,å®ƒæ˜¯Androidå®˜æ–¹æä¾›ç»™å› é…ç½®æ”¹å˜è€Œè¦ä¿å­˜çš„æ•°æ®çš„ã€‚activityä¸­æœ‰ä¸ªonRetainCustomNonConfigurationInstanceæ–¹æ³•ï¼Œä»–ä¼šåœ¨onStopå’ŒonDeatoryçš„æ—¶å€™ä¼šåœ¨onRetainCustomNonConfigurationInstanceä¸­ä¿å­˜çš„è‡ªå®šä¹‰éé…ç½®å®ä¾‹&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@Suppress(&amp;quot;deprecation&amp;quot;)
final override fun onRetainNonConfigurationInstance(): Any? {
    &#x2F;&#x2F; Maintain backward compatibility.
    val custom = onRetainCustomNonConfigurationInstance()
    var viewModelStore = _viewModelStore
    if (viewModelStore == null) {
        &#x2F;&#x2F; No one called getViewModelStore(), so see if there was an existing
        &#x2F;&#x2F; ViewModelStore from our last NonConfigurationInstance
        val nc = lastNonConfigurationInstance as NonConfigurationInstances?
        if (nc != null) {
            viewModelStore = nc.viewModelStore
        }
    }
    if (viewModelStore == null &amp;amp;&amp;amp; custom == null) {
        return null
    }
    val nci = NonConfigurationInstances()
    nci.custom = custom
    nci.viewModelStore = viewModelStore
    return nci
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘ä»¬å°±æ˜¯åˆ©ç”¨è¿™é‡Œå»ä¿å­˜æˆ‘ä»¬çš„ViewmodelStoreã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;viewbinding&quot;&gt;ViewBinding&lt;&#x2F;h1&gt;
&lt;h2 id=&quot;cong-shou-xie-findviewbyid-dao-viewbinding&quot;&gt;ä» æ‰‹å†™&lt;code&gt;findViewById&lt;&#x2F;code&gt; åˆ° ViewBinding&lt;&#x2F;h2&gt;
&lt;p&gt;å¦‚æ ‡é¢˜æ‰€ç¤ºï¼ŒViewBindingçš„ç”¨å¤„å°±æ˜¯ä¸ºäº†ä»£æ›¿&lt;code&gt;findViewById&lt;&#x2F;code&gt;ï¼Œéƒ¨åˆ†ä¸UIæ§ä»¶ç›¸å…³çš„ä»£ç å¯ä»¥åœ¨å¸ƒå±€æ–‡ä»¶ä¸­å®Œæˆã€‚ä½¿ç”¨ ViewBindingåï¼Œä¸å†éœ€è¦findViewById()æ–¹æ³•ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;viewbindingde-shi-yong&quot;&gt;ViewBindingçš„ä½¿ç”¨&lt;&#x2F;h2&gt;
&lt;ol&gt;
&lt;li&gt;å¯ç”¨Viewbindingï¼Œåœ¨appæ¨¡å—ç›®å½•ä¸‹ &lt;strong&gt;&lt;code&gt;build.gradle&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt; æ·»åŠ ä¸‹è¿°é…ç½®ï¼š&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Groovy&quot;&gt;android {
    ...
    viewBinding{
        enable = true
    }
    &#x2F;&#x2F; æˆ–è€…
    buildFeatures{
        viewBinding = true
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;é…ç½®è¿‡åï¼Œæˆ‘ä»¬çš„æ¯ä¸€ä¸ªlayoutæ–‡ä»¶éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„ç»‘å®šç±»ï¼Œè¯¥ç»‘å®šç±»çš„å‘½åå°±æ˜¯ layou æ–‡ä»¶çš„åç§°è½¬æ¢ä¸ºé©¼å³°å½¢å¼ï¼Œå¹¶åœ¨æœ«å°¾æ·»åŠ  Binding ä¸€è¯ã€‚ä»¥ activity_main.xml ä¸ºä¾‹ï¼Œå…¶å¯¹åº”çš„ç»‘å®šç±»åç§°ä¸º ActivityMainBindingã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ä¸Šé¢è¯´äº†ä¼šä¸ºæ¯ä¸ªlayoutæ–‡ä»¶éƒ½ç”Ÿæˆä¸€ä¸ªç»‘å®šç±»ï¼Œå¦‚æœè¯¥å¸ƒå±€æ–‡ä»¶ä¸éœ€è¦çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;tools:viewBinding-Ignore&lt;&#x2F;code&gt; å±æ€§æ¥è®¾ç½®&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;xml&quot;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;
&amp;lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&amp;quot;
    xmlns:tools=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;tools&amp;quot;
    tools:viewBinding-Ignore=&amp;quot;true&amp;quot;
    android:layout_width=&amp;quot;match_parent&amp;quot;
    android:layout_height=&amp;quot;match_parent&amp;quot;&amp;gt;

&amp;lt;&#x2F;androidx.constraintlayout.widget.ConstraintLayout&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨Activityä¸­ä½¿ç”¨ViewBinding&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;activity_main.xml&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;xml&quot;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;
&amp;lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&amp;quot;
    xmlns:app=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res-auto&amp;quot;
    android:id=&amp;quot;@+id&#x2F;main&amp;quot;
    android:layout_width=&amp;quot;match_parent&amp;quot;
    android:layout_height=&amp;quot;match_parent&amp;quot;&amp;gt;

    &amp;lt;TextView
        android:id=&amp;quot;@+id&#x2F;tv_main&amp;quot;
        android:layout_width=&amp;quot;wrap_content&amp;quot;
        android:layout_height=&amp;quot;wrap_content&amp;quot;
        android:text=&amp;quot;è¿™æ˜¯ä¸ªæ–‡æœ¬&amp;quot;
        app:layout_constraintBottom_toBottomOf=&amp;quot;parent&amp;quot;
        app:layout_constraintEnd_toEndOf=&amp;quot;parent&amp;quot;
        app:layout_constraintStart_toStartOf=&amp;quot;parent&amp;quot;
        app:layout_constraintTop_toTopOf=&amp;quot;parent&amp;quot; &#x2F;&amp;gt;

&amp;lt;&#x2F;androidx.constraintlayout.widget.ConstraintLayout&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;MainActivityä¸­&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;class MainActivity : AppCompatActivity() {

    &#x2F;&#x2F; é¦–å…ˆå£°æ˜å˜é‡
    private lateinit var binding: ActivityMainBinding
    
    &#x2F;&#x2F; æˆ–è€…ä½¿ç”¨æ‡’åŠ è½½
    private val binding by lazy {
        ActivityMainBinding.inflate(layoutInflater)
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        &#x2F;&#x2F; é€šè¿‡ç”Ÿæˆçš„bindingå»åŠ è½½å¸ƒå±€
        binding = ActivityMainBinding.inflate(layoutInflater)
        &#x2F;&#x2F; è°ƒç”¨bindingçš„getRoot()å¯ä»¥å¾—åˆ°activity_main.xmlçš„æ ¹å¸ƒå±€
        setContentView(binding.root)
        
        &#x2F;&#x2F; ä½¿ç”¨bindingå®ä¾‹è·å–åˆ°æ§ä»¶
        binding.tvMain.setOnClickListener {
            binding.tvMain.text = &amp;quot;æˆ‘è¢«ç‚¹å‡»äº†&amp;quot;
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h1 id=&quot;databinding&quot;&gt;DataBinding&lt;&#x2F;h1&gt;
&lt;p&gt;okï¼ŒèŠå®Œäº†ViewBindingï¼Œæˆ‘ä»¬æ¥èŠèŠDataBinding&lt;&#x2F;p&gt;
&lt;h2 id=&quot;shen-me-shi-databinding&quot;&gt;ä»€ä¹ˆæ˜¯DataBindingï¼Ÿ&lt;&#x2F;h2&gt;
&lt;p&gt;å‰é¢æåˆ°çš„ViewBindingå…¶å®å¯ä»¥çœ‹ä½œæ˜¯DataBindingçš„å­é›†ï¼Œä»–çš„åŠŸèƒ½åŸºæœ¬ä¸ŠDataBindingéƒ½æœ‰ï¼Œè€Œä¸”DataBindingè¿˜å¤šäº†æ•°æ®ç»‘å®šçš„åŠŸèƒ½ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¸¾ä¸ªç®€å•ä¾‹å­&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªè®¡æ•°å™¨åŠŸèƒ½ï¼Œæœ‰ä¸ªå˜é‡numï¼Œä¸€ä¸ªæ˜¾ç¤ºçš„TextViewï¼ŒäºŒè€…ç»‘å®šï¼Œå½“numå˜åŒ–æ—¶ï¼ŒTextViewè‡ªåŠ¨åˆ·æ–°ï¼Œä¸éœ€æˆ‘ä»¬æ‰‹åŠ¨setTextäº†ã€‚&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;p&gt;ä¸Šé¢è¿™ç§å«å•å‘ç»‘å®šï¼Œè¿˜æœ‰ä¸€ç§åŒå‘ç»‘å®šï¼Œå°±æ˜¯è§†å›¾å‘ç”Ÿæ”¹å˜ä¼šä½¿å¾—æ•°æ®æºä¹Ÿå‘ç”Ÿå˜åŒ–ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;databindingyong-fa&quot;&gt;Databindingç”¨æ³•&lt;&#x2F;h2&gt;
&lt;p&gt;ä¸ViewBindingä¸€æ ·ï¼Œå…ˆå¯ç”¨&lt;&#x2F;p&gt;
&lt;p&gt;åœ¨appæ¨¡å—ç›®å½•ä¸‹ &lt;strong&gt;&lt;code&gt;build.gradle&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt; æ·»åŠ ä¸‹è¿°é…ç½®ï¼š&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Groovy&quot;&gt;android {
    ...
    dataBinding {
        enable = true
    }
    &#x2F;&#x2F; äºŒé€‰ä¸€å³å¯
    buildFeatures {
        dataBinding = true
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å†™ä¸€ä¸ªè®¡æ•°å™¨çš„ä¾‹å­&lt;&#x2F;p&gt;
&lt;p&gt;activityä¸­&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;class DatabindingActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContentView(R.layout.activity_databinding)
        var num = 0
        val tv = findViewById&amp;lt;TextView&amp;gt;(R.id.tv_databinding)
        
        findViewById&amp;lt;Button&amp;gt;(R.id.bt_databinding).setOnClickListener { 
            tv.text = &amp;quot;è®¡æ•°å™¨ï¼š${++num}&amp;quot;
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;è¿™æ˜¯æˆ‘ä»¬æ™®é€šå†™æ³•ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ä½¿ç”¨DataBinding&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;æ¥åˆ°layoutæ–‡ä»¶ï¼Œå°†é¼ æ ‡æ”¾åˆ°æ ¹å¸ƒå±€ä¸Šï¼ŒæŒ‰Altå’ŒEnteré”®ï¼Œç‚¹å‡»**&lt;code&gt;Convert to data binding layout&lt;&#x2F;code&gt;**&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;6.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;ç”Ÿæˆä¹‹åçš„æ–‡ä»¶&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;7.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œåœ¨dataæ ‡ç­¾ä¸­æ·»åŠ å±æ€§ï¼Œå¹¶å°†TextViewæŒ‡å‘è¯¥å±æ€§&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;xml&quot;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;
&amp;lt;layout xmlns:android=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&amp;quot;&amp;gt;

    &amp;lt;data&amp;gt;
        &amp;lt;variable
            name=&amp;quot;mNum&amp;quot;
            type=&amp;quot;int&amp;quot; &#x2F;&amp;gt;
    &amp;lt;&#x2F;data&amp;gt;

    &amp;lt;LinearLayout
        android:layout_width=&amp;quot;match_parent&amp;quot;
        android:layout_height=&amp;quot;match_parent&amp;quot;
        android:orientation=&amp;quot;vertical&amp;quot;&amp;gt;

        &amp;lt;TextView
            android:id=&amp;quot;@+id&#x2F;tv_databinding&amp;quot;
            android:layout_width=&amp;quot;match_parent&amp;quot;
            android:layout_height=&amp;quot;48dp&amp;quot;
            android:gravity=&amp;quot;center&amp;quot;
            android:text=&amp;quot;@{`è®¡æ•°å™¨ï¼š`+ mNum}&amp;quot; &#x2F;&amp;gt;

        &amp;lt;Button
            android:id=&amp;quot;@+id&#x2F;bt_databinding&amp;quot;
            android:layout_width=&amp;quot;100dp&amp;quot;
            android:layout_height=&amp;quot;wrap_content&amp;quot;
            android:layout_gravity=&amp;quot;center_horizontal&amp;quot;
            android:text=&amp;quot;å¢åŠ &amp;quot; &#x2F;&amp;gt;

    &amp;lt;&#x2F;LinearLayout&amp;gt;
&amp;lt;&#x2F;layout&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä½¿ç”¨variableå±æ€§å†™æˆ‘ä»¬çš„å˜é‡ï¼Œåœ¨åˆ°TextViewä¸­çš„android:textæŒ‡å‘å±æ€§&lt;&#x2F;p&gt;
&lt;p&gt;å†åˆ°activityä¸­&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;class DatabindingActivity : AppCompatActivity() {
    private val binding by lazy {
        ActivityDatabindingBinding.inflate(layoutInflater)
    }
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContentView(binding.root)
        binding.mNum = 0
        findViewById&amp;lt;Button&amp;gt;(R.id.bt_databinding).setOnClickListener {
            binding.mNum++
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;è¿™æ ·åŒæ ·å®ç°äº†è®¡æ•°å™¨çš„æ•ˆæœã€‚&lt;&#x2F;p&gt;
&lt;p&gt;okï¼Œå…³äºDataBindingï¼Œæˆ‘ä»¬å°±è®²è¿™äº›ï¼Œå¦‚æœæƒ³è¦æ·±å…¥äº†è§£çš„åŒå­¦å¯ä»¥ç½‘ä¸Šè‡ªè¡Œæ‰¾èµ„æ–™ï¼Œæˆ–è€…çœ‹ä¸‹é¢çš„æ–‡ç« &lt;&#x2F;p&gt;
&lt;p&gt;&lt;a rel=&quot;external&quot; href=&quot;https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;6844903550808489998?searchId=202503201011098523E66CDAABD5A5B413&quot;&gt;Data Binding (ä¸­æ–‡æ–‡æ¡£)è¿™ç¯‡æ–‡æ¡£å°†æ•™ä½ å¦‚ä½•è¿ç”¨ Data Binding ç±»åº“æ¥ç¼–å†™å£°æ˜è¯•å¸ƒå±€ï¼Œå¹¶ä¸”å°½é‡å‡ - æ˜é‡‘&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;h1 id=&quot;navigation&quot;&gt;Navigation&lt;&#x2F;h1&gt;
&lt;p&gt;å¤§å®¶åº”è¯¥éƒ½ç”¨è¿‡Fragmentï¼Œè€ŒNavigationæ˜¯ä¸ºäº†æˆ‘ä»¬æ›´å¥½çš„ç®¡ç†Fragmentè€Œæ¨å‡ºçš„ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å®ƒæœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;å¯è§†åŒ–çš„é¡µé¢å¯¼èˆªå›¾ï¼Œä¾¿äºæˆ‘ä»¬ç†æ¸…é¡µé¢é—´çš„å…³ç³»ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;é€šè¿‡destinationå’Œactionå®Œæˆé¡µé¢é—´çš„å¯¼èˆªã€‚&lt;&#x2F;li&gt;
&lt;li&gt;æ–¹ä¾¿æ·»åŠ é¡µé¢åˆ‡æ¢åŠ¨ç”»ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;é¡µé¢é—´ç±»å‹å®‰å…¨çš„å‚æ•°ä¼ é€’ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;é€šè¿‡NavigationUIç±»ï¼Œå¯¹èœå•ã€åº•éƒ¨å¯¼èˆªã€æŠ½å±‰èœå•å¯¼èˆªè¿›è¡Œç»Ÿä¸€çš„ç®¡ç†ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;æ”¯æŒæ·±å±‚é“¾æ¥DeepLinkã€‚&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;navigationde-shi-yong&quot;&gt;Navigationçš„ä½¿ç”¨&lt;&#x2F;h2&gt;
&lt;p&gt;æ·»åŠ ä¾èµ–&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Groovy&quot;&gt;dependencies {
    val nav_version = &amp;quot;2.8.9&amp;quot;
    implementation(&amp;quot;androidx.navigation:navigation-fragment-ktx:$nav_version&amp;quot;)
    implementation(&amp;quot;androidx.navigation:navigation-ui-ktx:$nav_version&amp;quot;)
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥è®¤è¯†ä¸€ä¸‹ï¼ŒNavigationçš„ä¸‰ä¸ªç»„æˆ&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Navigation Graph&lt;&#x2F;strong&gt;ï¼šå­˜æ”¾åœ¨&lt;code&gt;res&#x2F;navigation&lt;&#x2F;code&gt;ç›®å½•ä¸‹ï¼Œç”¨æ¥æè¿°å¯¼èˆªç›¸å…³ä¿¡æ¯çš„ XML èµ„æº&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;NavHostFragment&lt;&#x2F;strong&gt;ï¼šæ˜¾ç¤ºå¯¼èˆªå›¾ä¸­ç›®æ ‡çš„ç©ºç™½å®¹å™¨ï¼Œå…¶å®å°±æ˜¯ç”¨æ¥æ”¾ç½® &lt;code&gt;fragment&lt;&#x2F;code&gt;çš„çˆ¶å®¹å™¨&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;NavController&lt;&#x2F;strong&gt;ï¼š çœŸæ­£çš„ç”¨äºå¯¼èˆªåŠ¨ä½œå®ç°çš„æ§åˆ¶è€…ï¼Œç”¨äºåœ¨ä»£ç ä¸­å®ŒæˆNavigation Graphä¸­å…·ä½“çš„é¡µé¢åˆ‡æ¢å·¥ä½œã€‚&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;okï¼Œè®¤è¯†å®Œäº†ä¹‹åï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹ç”¨æ³•&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»ºNavigation Graphï¼Œæ–°å»º&lt;code&gt;res&#x2F;navigation&lt;&#x2F;code&gt;ç›®å½•ï¼Œä¾æ¬¡é€‰ä¸­resæ–‡ä»¶å¤¹-&amp;gt;New-&amp;gt;Android Resource File&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;8.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;9.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Resource typeé€‰æ‹©navigationã€‚&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;ç„¶åæ–°å»ºä¸€ä¸ª&lt;code&gt;navigation&lt;&#x2F;code&gt;çš„&lt;code&gt;resource&lt;&#x2F;code&gt;æ–‡ä»¶&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;10.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;å‘å…¶ä¸­æ·»åŠ æˆ‘ä»¬çš„Fragmentï¼ˆè¿™é‡Œå‡†å¤‡äº†ä¸‰ä¸ªHomeFragmentï¼ŒBlankFragmentï¼ŒMineFragmentï¼‰&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;pre&gt;&lt;code data-lang=&quot;xml&quot;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;
&amp;lt;navigation xmlns:android=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&amp;quot;
    xmlns:app=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res-auto&amp;quot;
    xmlns:tools=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;tools&amp;quot;
    android:id=&amp;quot;@+id&#x2F;nav_graph&amp;quot;
    app:startDestination=&amp;quot;@+id&#x2F;fragment_home&amp;quot;&amp;gt;

    &amp;lt;fragment
        android:id=&amp;quot;@+id&#x2F;fragment_home&amp;quot;
        android:name=&amp;quot;com.sanhuzhen.jetpackdemo.fragment.HomeFragment&amp;quot;
        android:label=&amp;quot;fragment_home&amp;quot;
        tools:layout=&amp;quot;@layout&#x2F;fragment_home&amp;quot;&#x2F;&amp;gt;
    &amp;lt;fragment
        android:id=&amp;quot;@+id&#x2F;fragment_blank&amp;quot;
        android:name=&amp;quot;com.sanhuzhen.jetpackdemo.fragment.BlankFragment&amp;quot;
        android:label=&amp;quot;fragment_blank&amp;quot;
        tools:layout=&amp;quot;@layout&#x2F;fragment_blank&amp;quot; &#x2F;&amp;gt;

    &amp;lt;fragment
        android:id=&amp;quot;@+id&#x2F;fragment_mine&amp;quot;
        android:name=&amp;quot;com.sanhuzhen.jetpackdemo.fragment.MineFragment&amp;quot;
        android:label=&amp;quot;fragment_mine&amp;quot;
        tools:layout=&amp;quot;@layout&#x2F;fragment_mine&amp;quot;&#x2F;&amp;gt;

&amp;lt;&#x2F;navigation&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;åŠ å®Œä¹‹åï¼Œå°±å¯ä»¥ç”¨asè¿›è¡Œå¯è§†åŒ–æ“ä½œï¼Œå®ç°ä¸åŒfragmentä¹‹é—´çš„è·³è½¬è·¯å¾„&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;11.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;ä¹‹åå¯ä»¥çœ‹åˆ°xmlæ–‡ä»¶ä¸­åŠ äº†ä¸€ç‚¹ä¸œè¥¿&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;bash&quot;&gt;&amp;lt;fragment
    android:id=&amp;quot;@+id&#x2F;fragment_home&amp;quot;
    android:name=&amp;quot;com.sanhuzhen.jetpackdemo.fragment.HomeFragment&amp;quot;
    android:label=&amp;quot;fragment_home&amp;quot;
    tools:layout=&amp;quot;@layout&#x2F;fragment_home&amp;quot;&amp;gt;
    &amp;lt;action
        android:id=&amp;quot;@+id&#x2F;action_fragment_home_to_fragment_blank&amp;quot;
        app:destination=&amp;quot;@id&#x2F;fragment_blank&amp;quot; &#x2F;&amp;gt;
&amp;lt;&#x2F;fragment&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°è¿™é‡ŒåŠ äº†ä¸€ä¸ªå­ç»“ç‚¹actionï¼Œå­ç»“ç‚¹ä¸­çš„&lt;code&gt;destination&lt;&#x2F;code&gt;åˆ™å®šä¹‰äº†è¦è·³è½¬çš„ç›®æ ‡&lt;code&gt;fragment&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨activityå¸ƒå±€ä¸­çš„å¤„ç†&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;åˆ‡æ¢åˆ°activityçš„å¸ƒå±€ä¸­æ¥&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;xml&quot;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;
&amp;lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&amp;quot;
    xmlns:app=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res-auto&amp;quot;
    xmlns:tools=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;tools&amp;quot;
    android:id=&amp;quot;@+id&#x2F;main&amp;quot;
    android:layout_width=&amp;quot;match_parent&amp;quot;
    android:layout_height=&amp;quot;match_parent&amp;quot;
    tools:context=&amp;quot;.activity.NavActivity&amp;quot;&amp;gt;
    &amp;lt;fragment
        android:id=&amp;quot;@+id&#x2F;nav_host_fragment&amp;quot;
        android:name=&amp;quot;androidx.navigation.fragment.NavHostFragment&amp;quot;
        android:layout_width=&amp;quot;match_parent&amp;quot;
        android:layout_height=&amp;quot;match_parent&amp;quot;
        app:defaultNavHost=&amp;quot;true&amp;quot;
        app:navGraph=&amp;quot;@navigation&#x2F;nav_graph&amp;quot;&#x2F;&amp;gt;
&amp;lt;&#x2F;androidx.constraintlayout.widget.ConstraintLayout&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;åœ¨å…¶å¸ƒå±€æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªfragmentæˆ–è€…fragmentContainerViewï¼Œå°†å…¶nameå±æ€§è®¾ç½®ä¸ºä¸‹é¢&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;xml&quot;&gt;android:name=&amp;quot;androidx.navigation.fragment.NavHostFragment&amp;quot;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;NavHostFragment&lt;&#x2F;code&gt;æ˜¯ä½œä¸º&lt;code&gt;Navigation&lt;&#x2F;code&gt;ä¸­&lt;code&gt;fragment&lt;&#x2F;code&gt;çš„æ˜¾ç¤ºè½½ä½“æ¥å‡ºç°çš„&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;app:defaultNavHost=&quot;true&quot;&lt;&#x2F;code&gt;è¿™ä¸ªè¡¨é¢è¯¥Fragmentä¼šè‡ªåŠ¨å¤„ç†ç³»ç»Ÿè¿”å›é”®ã€‚å³å½“ç”¨æˆ·æŒ‰ä¸‹æ‰‹æœºçš„è¿”å›æŒ‰é’®æ—¶ï¼Œç³»ç»Ÿèƒ½è‡ªåŠ¨å°†å½“å‰æ‰€å±•ç¤ºçš„Fragmenté€€å‡ºã€‚&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;app:navGraph&lt;&#x2F;code&gt;åˆ™æ˜¯è®¾ç½®è¯¥Fragmentå¯¹åº”çš„å¯¼èˆªå›¾&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;è·³è½¬é¡µé¢&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;æ¥åˆ°æˆ‘ä»¬çš„HomeFragmentçš„å¸ƒå±€ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæŒ‰é’®&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;xml&quot;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;
&amp;lt;FrameLayout xmlns:android=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&amp;quot;
    xmlns:tools=&amp;quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;tools&amp;quot;
    android:layout_width=&amp;quot;match_parent&amp;quot;
    android:layout_height=&amp;quot;match_parent&amp;quot;
    tools:context=&amp;quot;.fragment.HomeFragment&amp;quot;&amp;gt;
    &amp;lt;TextView
        android:layout_width=&amp;quot;match_parent&amp;quot;
        android:layout_height=&amp;quot;match_parent&amp;quot;
        android:text=&amp;quot;@string&#x2F;hello_blank_fragment&amp;quot; &#x2F;&amp;gt;
    &amp;lt;Button
        android:id=&amp;quot;@+id&#x2F;btn_test&amp;quot;
        android:layout_width=&amp;quot;wrap_content&amp;quot;
        android:layout_height=&amp;quot;wrap_content&amp;quot;
        android:layout_gravity=&amp;quot;center&amp;quot;
        android:text=&amp;quot;è·³è½¬&amp;quot; &#x2F;&amp;gt;
&amp;lt;&#x2F;FrameLayout&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ç„¶åæ¥åˆ°HomeFragment&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;class HomeFragment : Fragment() {

    private var _binding: FragmentHomeBinding? = null
    private val binding get() = _binding!!

    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        _binding = FragmentHomeBinding.inflate(inflater, container, false)
        return binding.root
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        binding.btn.setOnClickListener {
            Navigation.findNavController(it).navigate(R.id.action_fragment_home_to_fragment_blank)
        }
    }

    override fun onDestroyView() {
        super.onDestroyView()
        _binding = null  &#x2F;&#x2F; é¿å…å†…å­˜æ³„æ¼
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;è¿™é‡Œä½¿ç”¨ViewBindingï¼Œä½†Fragmentå­˜åœ¨æ—¶é—´æ¯”å…¶è§†å›¾é•¿ã€‚è¯·åŠ¡å¿…åœ¨ &lt;code&gt;Fragment&lt;&#x2F;code&gt; çš„ &lt;code&gt;onDestroyView()&lt;&#x2F;code&gt; æ–¹æ³•ä¸­æ¸…é™¤å¯¹ç»‘å®šç±»å®ä¾‹çš„æ‰€æœ‰å¼•ç”¨ã€‚&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;Navigation.findNavController(it).navigate(R.id.action_fragment_home_to_fragment_blank)
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä½¿ç”¨ä¸Šé¢è¿™å¥è¿›è¡Œé¡µé¢è·³è½¬ï¼Œè¿™é‡Œçš„idå³æ˜¯æˆ‘ä»¬çš„actionçš„id&lt;&#x2F;p&gt;
&lt;h1 id=&quot;room&quot;&gt;Room&lt;&#x2F;h1&gt;
&lt;h2 id=&quot;shen-me-shi-room&quot;&gt;ä»€ä¹ˆæ˜¯Roomï¼Ÿ&lt;&#x2F;h2&gt;
&lt;p&gt;Roomæ˜¯æ˜¯ç”¨äºå¤„ç†æœ¬åœ°æ•°æ®åº“çš„åº“ã€‚Room æŒä¹…æ€§åº“åœ¨ SQLite ä¸Šæä¾›äº†ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œä»¥ä¾¿åœ¨å……åˆ†åˆ©ç”¨ SQLite çš„å¼ºå¤§åŠŸèƒ½çš„åŒæ—¶ï¼Œèƒ½å¤Ÿæµç•…åœ°è®¿é—®æ•°æ®åº“ã€‚å…·ä½“æ¥è¯´ï¼ŒRoom å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;é’ˆå¯¹ SQL æŸ¥è¯¢çš„ç¼–è¯‘æ—¶éªŒè¯ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;å¯æœ€å¤§é™åº¦å‡å°‘é‡å¤å’Œå®¹æ˜“å‡ºé”™çš„æ ·æ¿ä»£ç çš„æ–¹ä¾¿æ³¨è§£ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;ç®€åŒ–äº†æ•°æ®åº“è¿ç§»è·¯å¾„ã€‚&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;roomde-zu-cheng&quot;&gt;Roomçš„ç»„æˆ&lt;&#x2F;h2&gt;
&lt;p&gt;Roomä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªç»„ä»¶ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;DataBase&lt;&#x2F;strong&gt;ï¼šä¿å­˜æ•°æ®åº“å¹¶ä½œä¸ºåº”ç”¨æŒä¹…æ€§æ•°æ®åº•å±‚è¿æ¥çš„ä¸»è¦è®¿é—®ç‚¹&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;Entity&lt;&#x2F;strong&gt;ï¼šç”¨äºè¡¨ç¤ºåº”ç”¨çš„æ•°æ®åº“ä¸­çš„è¡¨&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;Dao&lt;&#x2F;strong&gt;ï¼šæä¾›ä½ çš„åº”ç”¨å¯ç”¨äºæŸ¥è¯¢ã€æ›´æ–°ã€æ’å…¥å’Œåˆ é™¤æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ–¹æ³•&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ä½¿ç”¨æ—¶ä¸€èˆ¬éƒ½å…ˆé€šè¿‡DataBaseè·å–åˆ°Daoï¼Œç„¶åç”¨Daoæ¥æ“ä½œEntity&lt;&#x2F;p&gt;
&lt;h2 id=&quot;roomde-shi-yong&quot;&gt;Roomçš„ä½¿ç”¨&lt;&#x2F;h2&gt;
&lt;p&gt;é¦–å…ˆæ·»åŠ ä¾èµ–&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;Kotlin&quot;&gt;dependencies {
    val room_version = &amp;quot;2.6.1&amp;quot;
    implementation(&amp;quot;androidx.room:room-runtime:$room_version&amp;quot;)
    annotationProcessor(&amp;quot;androidx.room:room-compiler:$room_version&amp;quot;)
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;jian-biao&quot;&gt;å»ºè¡¨&lt;&#x2F;h3&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@Entity
data class User(
    @PrimaryKey &#x2F;&#x2F; ä¸»é”®
    var uId: Int,
    @ColumnInfo(name = &amp;quot;user_name&amp;quot;)
    var userName: String,
    @ColumnInfo(name = &amp;quot;user_age&amp;quot;)
    var userAge: Int,
    @Ignore
    var gender: String
)
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;@Entity&lt;&#x2F;code&gt;ï¼šç”¨äºå°†Userç±»ä¸Roomä¸­çš„æ•°æ®è¡¨å¯¹åº”èµ·æ¥ã€‚tableNameå±æ€§å¯ä»¥ä¸ºæ•°æ®è¡¨è®¾ç½®è¡¨ åï¼Œè‹¥ä¸è®¾ç½®ï¼Œåˆ™è¡¨åå’Œç±»åç›¸åŒã€‚&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;@PrimaryKey&lt;&#x2F;code&gt;ï¼šç”¨äºæŒ‡å®šè¯¥å­—æ®µä½œä¸ºè¡¨çš„ä¸»é”®&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;@ColumnInfo&lt;&#x2F;code&gt;ï¼šç”¨äºè®¾ç½®è¯¥å­—æ®µå­˜å‚¨åœ¨æ•°æ®åº“è¡¨ä¸­çš„åå­—ã€‚è‹¥ä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤ä½¿ç”¨å­—æ®µåç§°ä½œä¸ºæ•°æ®åº“ä¸­çš„åˆ—åç§°&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;@Ignore&lt;&#x2F;code&gt;ï¼šå‘Šè¯‰Roomå¿½ç•¥è¯¥å­—æ®µæˆ–æ–¹æ³•&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿˜æœ‰å…¶ä»–çš„ï¼Œæ„Ÿå…´è¶£å¯ä»¥ç‚¹å‡»ä¸‹é¢é“¾æ¥&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;7205417093973884983?searchId=202503221327580BFBF2FE3B9DF27C8C76&lt;&#x2F;p&gt;
&lt;h3 id=&quot;chuang-jian-shu-ju-fang-wen-dui-xiang-dao&quot;&gt;åˆ›å»ºæ•°æ®è®¿é—®å¯¹è±¡(DAO)&lt;&#x2F;h3&gt;
&lt;p&gt;æ–°å»ºä¸€ä¸ªåä¸ºUserDaoçš„æ¥å£æ–‡ä»¶ï¼Œå¹¶åœ¨æ¥å£çš„ä¸Šæ–¹æ·»åŠ @Daoæ ‡ç­¾ã€‚&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;@Insert&lt;&#x2F;code&gt;ï¼šå®šä¹‰å°†å…¶å‚æ•°æ’å…¥æ•°æ®åº“ä¸­çš„ç›¸åº”è¡¨çš„æ–¹æ³•ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;@Update&lt;&#x2F;code&gt;ï¼šå®šä¹‰ç”¨äºæ›´æ–°æ•°æ®åº“è¡¨ä¸­ç‰¹å®šè¡Œçš„æ–¹æ³•ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;@Delete&lt;&#x2F;code&gt;ï¼šå®šä¹‰ç”¨äºä»æ•°æ®åº“è¡¨ä¸­åˆ é™¤ç‰¹å®šè¡Œçš„æ–¹æ³•ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;@Query&lt;&#x2F;code&gt;ï¼šå®šä¹‰ç”¨äºè‡ªå·±ç¼–å†™ SQL è¯­å¥&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@Dao
interface UserDao {
    &#x2F;**
     * æ’å…¥æ•°æ®ï¼Œå½“ä¸»é”®å†²çªæ—¶é€‰æ‹©ç›´æ¥è¦†ç›–åŸæ•°æ®
     *
     * å¯é€‰æ•°æ®ï¼š
     * OnConflictStrategy.REPLACE å¦‚æœå‘ç”Ÿå†²çªï¼Œç›´æ¥è¦†ç›–å·²æœ‰æ•°æ®ï¼Œå°†è¡¨ä¸­ç°å­˜çš„æ•°æ®æ›¿æ¢æˆæ’å…¥çš„è¿™æ¡ï¼›
     * OnConflictStrategy.IGNORE å¦‚æœå‘ç”Ÿå†²çªï¼Œç›´æ¥å¿½ç•¥æ­¤æ¬¡æ’å…¥æ“ä½œ
     * OnConflictStrategy.NONE è¿™ä¸ªæ˜¯é»˜è®¤çš„ç­–ç•¥ï¼Œå®ƒå’ŒABORTä½œç”¨æ˜¯ä¸€è‡´çš„ï¼Œéƒ½æ˜¯ç»ˆæ­¢æ­¤æ¬¡æ’å…¥æ“ä½œï¼Œå¹¶ä¸”æŠ›å‡ºSQLiteConstraintException
     * OnConflictStrategy.ROLLBACK è¿™ä¸ªè¡¨ç¤ºå¦‚æœå‘ç”Ÿå†²çªï¼Œç»ˆæ­¢æ’å…¥æ“ä½œï¼Œå¹¶ä¸”å°†äº‹åŠ¡å›æ»šåˆ°æœ€åˆçš„çŠ¶æ€ï¼Œåœ¨æœ€æ–°ç‰ˆæœ¬å·²ç»è¢«æ ‡è®°@Deprecatedæ¨èä½¿ç”¨ABORT
     * OnConflictStrategy.ABORT å’ŒNONEä½œç”¨ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šä»‹ç»
     * OnConflictStrategy.FAIL è¿™ä¸ªè¡¨ç¤ºå¦‚æœå‘ç”Ÿå†²çªï¼Œç»ˆæ­¢æ’å…¥æ“ä½œï¼Œå¹¶ä¸”æŠ›å‡ºSQLiteConstraintExceptionå¼‚å¸¸ï¼Œåœ¨æœ€æ–°ç‰ˆæœ¬ä¹Ÿæ˜¯è¢«æ ‡è®°@Deprecatedï¼Œä¹Ÿæ˜¯æ¨èä½¿ç”¨ABORTã€‚
     *&#x2F;
    @Insert(onConflict = OnConflictStrategy.REPLACE)
    fun insert(user: User)

    &#x2F;**
     * åˆ é™¤æ•°æ®
     *&#x2F;
    @Delete
    fun delete(user: User)

    &#x2F;**
     * åˆ é™¤æ‰€æœ‰ç”¨æˆ·ï¼Œä½¿ç”¨Queryæ³¨è§£å¯ä»¥æ‰§è¡Œè‡ªå®šä¹‰çš„SQLè¯­å¥
     *&#x2F;
    @Query(&amp;quot;DELETE FROM user&amp;quot;)
    fun deleteAll()

    &#x2F;**
     * æ›´æ–°æ•°æ®
     *&#x2F;
    @Update
    fun update(user: User)

    &#x2F;**
     * æŸ¥è¯¢æ•°æ®
     *&#x2F;
    @Query(&amp;quot;select * from user where uId=:id&amp;quot;)
    fun queryById(id : Int): User?

    @Query(&amp;quot;select * from user&amp;quot;)
    fun queryAll(): List&amp;lt;User&amp;gt;
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;chuang-jian-shu-ju-ku&quot;&gt;åˆ›å»ºæ•°æ®åº“&lt;&#x2F;h3&gt;
&lt;p&gt;&lt;code&gt;@Database&lt;&#x2F;code&gt;ç”¨äºå‘Šè¯‰ç³»ç»Ÿè¿™æ˜¯Roomæ•°æ®åº“å¯¹è±¡ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;entities&lt;&#x2F;code&gt;å±æ€§ç”¨äºæŒ‡å®šè¯¥æ•°æ®åº“æœ‰å“ªäº›è¡¨ï¼Œè‹¥éœ€è¦å»ºç«‹å¤šå¼ è¡¨ï¼Œåˆ™è¡¨åä»¥é€—å·éš”å¼€ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;version&lt;&#x2F;code&gt;å±æ€§ç”¨äºæŒ‡å®šæ•°æ®åº“ç‰ˆæœ¬å·ï¼Œåé¢æ•°æ®åº“çš„å‡çº§æ­£æ˜¯ä¾æ®ç‰ˆæœ¬å·è¿›è¡Œåˆ¤æ–­çš„ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æ•°æ®åº“ç±»å¿…é¡»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç”¨äºæ‹“å±•&lt;code&gt;RoomDatabase&lt;&#x2F;code&gt;ã€‚å¯¹äºä¸æ•°æ®åº“å…³è”çš„æ¯ä¸ªDAOç±»ï¼Œæ•°æ®åº“ç±»å¿…é¡»å®šä¹‰ä¸€ä¸ªå…·æœ‰é›¶å‚æ•°çš„æŠ½è±¡æ–¹æ³•ï¼Œå¹¶è¿”å› DAO ç±»çš„å®ä¾‹ã€‚&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@Database(entities = [User::class], version = 1)
abstract class AppDataBase: RoomDatabase() {
    abstract fun userDao(): UserDao
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;shi-yong&quot;&gt;ä½¿ç”¨&lt;&#x2F;h3&gt;
&lt;p&gt;åˆ›é€ æ•°æ®åº“å®ä¾‹&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;class RoomActivity : AppCompatActivity() {

    private val userDataBase by lazy {
        Room.databaseBuilder(this, AppDataBase::class.java, &amp;quot;user.db&amp;quot;).build()
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContentView(R.layout.activity_room)

    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;é€šè¿‡æ‡’åŠ è½½åˆ›é€ æ•°æ®åº“å®ä¾‹ï¼Œç„¶åå°±å¯ä»¥ç”¨Daoå»å¤„ç†ç›¸å…³æ•°æ®&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;Jetpack%E7%9A%84%E4%BD%BF%E7%94%A8&#x2F;12.png&quot; alt=&quot;img&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;é™¤äº†ä¸Šè¿°æ–¹æ³•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨AppDatabaseé‡Œå°è£…å®ä¾‹åŒ–æ•°æ®åº“çš„ä»£ç &lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;companion object {
    private lateinit var INSTANCE: AppDataBase
    fun getDatabase(context: Context): AppDataBase {
        synchronized(AppDataBase::class) {
            if (!::INSTANCE.isInitialized) {
                INSTANCE = Room.databaseBuilder(
                    context, AppDataBase::class.java, &amp;quot;user.db&amp;quot;
                ).fallbackToDestructiveMigration().build()
            }
        }
        return INSTANCE
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;sheng-ji-shu-ju-ku&quot;&gt;å‡çº§æ•°æ®åº“&lt;&#x2F;h2&gt;
&lt;p&gt;å½“æˆ‘ä»¬è¦å¢åŠ æˆ–åˆ é™¤æ•°æ®åº“ä¸­å­—æ®µåï¼Œæˆ‘ä»¬å°±éœ€è¦å‡çº§æ•°æ®åº“çš„ç‰ˆæœ¬ï¼Œåœ¨Roomä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡&lt;code&gt;@DataBase&lt;&#x2F;code&gt;ä¸­çš„&lt;code&gt;autoMigrations&lt;&#x2F;code&gt;å±æ€§æ¥å®Œæˆï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³å°†user_nameåˆ—åæ”¹ä¸ºuserName&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;@Database(
    entities = [User::class],
    version = 2,
    autoMigrations = [AutoMigration(1, 2, ReNameColumnMigration::class)]
)
abstract class AppDataBase : RoomDatabase() {
    abstract fun userDao(): UserDao
}

@RenameColumn(fromColumnName = &amp;quot;user_name&amp;quot;, tableName = &amp;quot;user&amp;quot;, toColumnName = &amp;quot;userName&amp;quot;)
class ReNameColumnMigration : AutoMigrationSpec
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ–è€…é€šè¿‡Migration ç±»æ¥æ‰‹åŠ¨å®šä¹‰è¿ç§»è·¯å¾„ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³åŠ ä¸€åˆ—birthday&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;val MIGRATION_1_2 = object : Migration(1, 2) {
    override fun migrate(database: SupportSQLiteDatabase) {
        database.execSQL(&amp;quot;ALTER TABLE user ADD COLUMN birthday TEXT&amp;quot;)
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ç„¶åå†åˆ°åˆ›å»ºå®ä¾‹æ—¶&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;kotlin&quot;&gt;fun getDatabase(context: Context): AppDataBase {
    synchronized(AppDataBase::class) {
        if (!::INSTANCE.isInitialized) {
            INSTANCE = Room.databaseBuilder(
                context.applicationContext, AppDataBase::class.java, &amp;quot;user.db&amp;quot;
            ).addMigrations(MIGRATION_1_2).fallbackToDestructiveMigration().build()
        }
    }
    return INSTANCE
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</description>
      </item>
      <item>
          <title>rustçš„åŸºæœ¬è¯­æ³•</title>
          <pubDate>Fri, 01 Nov 2024 00:00:00 +0000</pubDate>
          <author>Unknown</author>
          <link>https://blog.sanhuzhen.top/posts/rustde-ji-chu-yu-fa/</link>
          <guid>https://blog.sanhuzhen.top/posts/rustde-ji-chu-yu-fa/</guid>
          <description xml:base="https://blog.sanhuzhen.top/posts/rustde-ji-chu-yu-fa/">&lt;p&gt;æ‰“å° &lt;code&gt; Hello,World!&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    println!(&amp;quot;Hello,World!&amp;quot;);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;bian-liang&quot;&gt;å˜é‡&lt;&#x2F;h2&gt;
&lt;h3 id=&quot;ke-bian-xing&quot;&gt;å¯å˜æ€§&lt;&#x2F;h3&gt;
&lt;p&gt;rustä¸­çš„å˜é‡ä¸kotlinåŒæ ·å…·æœ‰å¯å˜æ€§å’Œä¸å¯å˜æ€§&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;let m = 6;
m = 7;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä¸Šè¿°å°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºç›´æ¥ä½¿ç”¨ &lt;code&gt; let&lt;&#x2F;code&gt;å£°æ˜çš„å˜é‡å…·å¤‡ä¸å¯å˜æ€§ï¼Œå³èµ‹å€¼ä¸€æ¬¡å°±ä¸å¯å˜äº†ï¼Œä¸kotlinä¸­çš„ &lt;code&gt; val&lt;&#x2F;code&gt;ä¸€è‡´&lt;&#x2F;p&gt;
&lt;p&gt;ä½†æˆ‘ä»¬å¯ä»¥ç”¨ &lt;code&gt; mut&lt;&#x2F;code&gt;æ¥å°†å˜é‡ &lt;code&gt; m&lt;&#x2F;code&gt;èµ‹äºˆå¯å˜æ€§ï¼Œå³&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;let mut m = 6;
m = 7;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;chang-liang&quot;&gt;å¸¸é‡&lt;&#x2F;h3&gt;
&lt;p&gt;åŒç†ï¼Œrustä¸­ä¸€æ ·ä¼šæœ‰å¸¸é‡ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥ä¸å…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œç”¨ &lt;code&gt; const&lt;&#x2F;code&gt;æ¥å£°æ˜å¸¸é‡&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;const MATH.PI: f64 = 3.1415926;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¸¸é‡é»˜è®¤ä¸å¯å˜ï¼Œå¹¶ä¸”å¿…é¡»è¡¨æ˜å…¶ç±»å‹ï¼Œæ¯”å¦‚ä¸Šè¿°çš„ &lt;code&gt; f64&lt;&#x2F;code&gt;å°±è¡¨æ˜ &lt;code&gt; MATH.PI&lt;&#x2F;code&gt;æ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°&lt;&#x2F;p&gt;
&lt;h3 id=&quot;yin-cang&quot;&gt;éšè—&lt;&#x2F;h3&gt;
&lt;p&gt;rustä¸­å¦‚æœæˆ‘ä»¬åœ¨åé¢æ–°å®šä¹‰äº†ä¸€ä¸ªä¸å‰é¢å˜é‡åä¸€æ ·çš„å˜é‡ï¼Œæˆ‘ä»¬å°±è¯´å‰ä¸€ä¸ªå˜é‡å°±è¢«è¿™ä¸€ä¸ªå˜é‡ç»™éšè—äº†ã€‚&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let mut x = 3;
    x = x * 2;
    {
        let x = x * 2;
        println!(&amp;quot;{x}&amp;quot;);
    }
    println!(&amp;quot;{x}&amp;quot;);
}
è¾“å‡ºï¼š
12
6

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt; {}&lt;&#x2F;code&gt;å°±æ˜¯ä¸€ä¸ªä½œç”¨åŸŸï¼Œæˆ‘ä»¬åœ¨æ–°çš„ä½œç”¨åŸŸä¸­ä½¿ç”¨ &lt;code&gt;let x =&lt;&#x2F;code&gt;åˆæ–°åˆ›é€ äº†ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œå°†ä¹‹å‰çš„éšè—äº†ï¼Œå½“ &lt;code&gt; {}&lt;&#x2F;code&gt;ç»“æŸåï¼Œxåˆè¿”å›ä¹‹å‰çš„å€¼ï¼Œæ•…è¾“å‡º6ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt; mut&lt;&#x2F;code&gt;å’Œéšè—çš„åŒºåˆ«ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt; mut&lt;&#x2F;code&gt;å¹¶ä¸ä¼šå—ä½œç”¨åŸŸçš„å½±å“ï¼Œå¦‚ä¸Šè¿™ä¸ªç¨‹åºï¼Œå¦‚æœä¸ç”¨ &lt;code&gt; let x =&lt;&#x2F;code&gt;å»æ–°åˆ›é€ ä¸€ä¸ªå˜é‡ï¼Œä»…å•å• &lt;code&gt; x = x * 2&lt;&#x2F;code&gt;é‚£ä¹ˆï¼Œé…’åç¨‹åºè¾“å‡ºçš„éƒ½æ˜¯12&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt; mut&lt;&#x2F;code&gt;è¿˜ä¸ä¼šæ”¹å˜å˜é‡çš„ç±»å‹ï¼Œè€Œéšè—å¯ä»¥æ”¹å˜è¿™ä¸ªæ–°çš„å˜é‡çš„ç±»å‹&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let str = &amp;quot;   &amp;quot;;
    let str = str.len();
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¦‚ä¸Šï¼Œæˆ‘ä»¬åˆ›é€ äº†ä¸€ä¸ª &lt;code&gt; str&lt;&#x2F;code&gt;å­—ç¬¦ä¸²ï¼Œååˆç”¨ &lt;code&gt; str&lt;&#x2F;code&gt;æ¥è¡¨ç¤º &lt;code&gt; str&lt;&#x2F;code&gt;çš„é•¿åº¦ï¼ŒäºŒè€…çš„ç±»å‹æ˜¯ä¸åŒçš„ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç”¨éšè—æ¥å®ç°ï¼Œå¦‚æœç”¨ &lt;code&gt; mut&lt;&#x2F;code&gt;é‚£è‚¯å®šå°±ä¸è¡Œã€‚&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;shu-ju-lei-xing&quot;&gt;æ•°æ®ç±»å‹&lt;&#x2F;h2&gt;
&lt;p&gt;rustæ˜¯ä¸€é—¨é™æ€ç±»å‹è¯­è¨€ï¼Œè¿™è¡¨æ˜ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ï¼Œå°±éœ€è¦çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;rustçš„æ•°æ®ç±»å‹ä¸»è¦åˆ†ä¸ºï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;æ ‡ç±»ï¼šæ•´å‹ï¼Œæµ®ç‚¹å‹ï¼Œå¸ƒå°”å‹å’Œå­—ç¬¦ç±»å‹ï¼ˆæ„Ÿè§‰å…¶ä»–è¯­è¨€çš„åŸºæœ¬ç±»å‹ä¹Ÿæ˜¯è¿™äº›ï¼Ÿï¼‰&lt;&#x2F;li&gt;
&lt;li&gt;å¤åˆ&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h3 id=&quot;biao-lei&quot;&gt;æ ‡ç±»&lt;&#x2F;h3&gt;
&lt;h4 id=&quot;zheng-xing&quot;&gt;æ•´å‹&lt;&#x2F;h4&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;æœ‰ç¬¦å·&lt;&#x2F;th&gt;&lt;th&gt;æ— ç¬¦å·&lt;&#x2F;th&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;thead&gt;&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;&lt;code&gt; i8&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;td&gt;&lt;code&gt; u8&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;code&gt; i16&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;td&gt;&lt;code&gt; u16&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;code&gt; i32&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;td&gt;&lt;code&gt; u32&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;code&gt; i64&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;td&gt;&lt;code&gt; u64&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;code&gt; i128&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;td&gt;&lt;code&gt; u128&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;code&gt; isize&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;td&gt;&lt;code&gt; usize&lt;&#x2F;code&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;&#x2F;tbody&gt;&lt;&#x2F;table&gt;
&lt;p&gt;æœ‰æ— ç¬¦å·ä»£è¡¨è¯¥æ•°æ˜¯å¦å¯ä»¥ä¸ºè´Ÿæ•°&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt; isize&lt;&#x2F;code&gt;å’Œ &lt;code&gt; usize&lt;&#x2F;code&gt;ç±»å‹ä¾èµ–äºè¿è¡Œç¨‹åºçš„è®¡ç®—æœºæ¶æ„ï¼Œ64ä½ä¸º64ä½ï¼Œ32ä½ä¸º32ä½&lt;&#x2F;p&gt;
&lt;h4 id=&quot;fu-dian-shu&quot;&gt;æµ®ç‚¹æ•°&lt;&#x2F;h4&gt;
&lt;p&gt;&lt;code&gt; f32&lt;&#x2F;code&gt;å’Œ &lt;code&gt; f64&lt;&#x2F;code&gt;åˆ†åˆ«å 32ä½å’Œ64ä½ï¼Œrusté»˜è®¤ä½ &lt;code&gt; f64&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let x = 3.2;&#x2F;&#x2F;f64
    let x: f32 = 3.2;&#x2F;&#x2F;f32
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h4 id=&quot;bu-er-xing&quot;&gt;å¸ƒå°”å‹&lt;&#x2F;h4&gt;
&lt;p&gt;ä¸å…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œrustä¹Ÿæœ‰ &lt;code&gt; bool&lt;&#x2F;code&gt;å‹å˜é‡&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let target = true;
    let target: bool = false;
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h4 id=&quot;zi-fu-lei-xing&quot;&gt;å­—ç¬¦ç±»å‹&lt;&#x2F;h4&gt;
&lt;p&gt;&lt;code&gt; char&lt;&#x2F;code&gt;ä¸»è¦ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ç±»å‹ï¼Œå­—ç¬¦ä¸€èˆ¬ç”¨å•å¼•å·æ¥å£°æ˜ &lt;code&gt; char&lt;&#x2F;code&gt;å­—é¢é‡&lt;&#x2F;p&gt;
&lt;h3 id=&quot;fu-he&quot;&gt;å¤åˆ&lt;&#x2F;h3&gt;
&lt;p&gt;rustä¸­å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ï¼Œrustæœ‰ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;å…ƒç»„ï¼ˆtupleï¼‰&lt;&#x2F;li&gt;
&lt;li&gt;æ•°ç»„ï¼ˆarrayï¼‰&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h4 id=&quot;yuan-zu&quot;&gt;å…ƒç»„&lt;&#x2F;h4&gt;
&lt;p&gt;å…ƒç»„æ˜¯ä¸€ä¸ªå°†å¤šä¸ªå…¶ä»–ç±»å‹çš„å€¼ç»„åˆè¿›ä¸€ä¸ªå¤åˆç±»å‹çš„ä¸»è¦æ–¹å¼ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å…ƒç»„é•¿åº¦å›ºå®šï¼šä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦ä¸ä¼šå¢å¤§æˆ–ç¼©å°ã€‚&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let tup: (i32, f64, u32) = (500, 3.14, 2);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h5 id=&quot;jie-gou&quot;&gt;è§£æ„&lt;&#x2F;h5&gt;
&lt;p&gt;ä¸ºäº†ä»å…ƒç»„ä¸­è·å–å•ä¸ªå€¼ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…ï¼ˆpattern matchingï¼‰æ¥è§£æ„ï¼ˆdestructureï¼‰å…ƒç»„å€¼&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let tup: (i32, f64, u32) = (500, 3.14, 2);
    let (x, y, z) = tup;
    println!(&amp;quot;{y}&amp;quot;);
}
è¾“å‡ºï¼š
3.14

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç‚¹å·ï¼ˆ&lt;code&gt;.&lt;&#x2F;code&gt;ï¼‰åè·Ÿå€¼çš„ç´¢å¼•æ¥ç›´æ¥è®¿é—®å®ƒä»¬ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let tup: (i32, f64, u32) = (500, 3.14, 2);
    let y = tup.1;
    println!(&amp;quot;{y}&amp;quot;);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä¸å¸¦ä»»ä½•å€¼çš„å…ƒç»„æœ‰ä¸ªç‰¹æ®Šçš„åç§°ï¼Œå«åš &lt;strong&gt;å•å…ƒï¼ˆunitï¼‰&lt;&#x2F;strong&gt; å…ƒç»„ã€‚è¿™ç§å€¼ä»¥åŠå¯¹åº”çš„ç±»å‹éƒ½å†™ä½œ &lt;code&gt;()&lt;&#x2F;code&gt;ï¼Œè¡¨ç¤ºç©ºå€¼æˆ–ç©ºçš„è¿”å›ç±»å‹ã€‚å¦‚æœè¡¨è¾¾å¼ä¸è¿”å›ä»»ä½•å…¶ä»–å€¼ï¼Œåˆ™ä¼šéšå¼è¿”å›å•å…ƒå€¼ã€‚&lt;&#x2F;p&gt;
&lt;h4 id=&quot;shu-zu&quot;&gt;æ•°ç»„&lt;&#x2F;h4&gt;
&lt;p&gt;æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒ&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä»¬å°†æ•°ç»„çš„å€¼å†™æˆåœ¨æ–¹æ‹¬å·å†…ï¼Œç”¨é€—å·åˆ†éš”ï¼š&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let nums = [0, 1, 2, 3, 4];
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¯ä»¥åƒè¿™æ ·ç¼–å†™æ•°ç»„çš„ç±»å‹ï¼šåœ¨æ–¹æ‹¬å·ä¸­åŒ…å«æ¯ä¸ªå…ƒç´ çš„ç±»å‹ï¼Œåè·Ÿåˆ†å·ï¼Œå†åè·Ÿæ•°ç»„å…ƒç´ çš„æ•°é‡ã€‚&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let nums: [i32: 5] = [0, 1, 2, 3, 4];
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;é€šè¿‡åœ¨æ–¹æ‹¬å·ä¸­æŒ‡å®šåˆå§‹å€¼åŠ åˆ†å·å†åŠ å…ƒç´ ä¸ªæ•°çš„æ–¹å¼æ¥åˆ›å»ºä¸€ä¸ªæ¯ä¸ªå…ƒç´ éƒ½ä¸ºç›¸åŒå€¼çš„æ•°ç»„ï¼š&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let nums = [3: 5];
    &#x2F;&#x2F;ç­‰ä»·äº let nums = [3, 3, 3, 3, 3];
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;han-shu&quot;&gt;å‡½æ•°&lt;&#x2F;h2&gt;
&lt;p&gt;å¯¹äºä»»æ„è¯­è¨€ï¼Œéƒ½æœ‰å‡½æ•°è¿™ä¸ªæ¦‚å¿µï¼Œrustä¹Ÿä¸€æ ·&lt;&#x2F;p&gt;
&lt;p&gt;rustä¸»è¦ç”¨ &lt;code&gt; fn&lt;&#x2F;code&gt;æ¥è¡¨ç¤ºä¸€ä¸ªå‡½æ•°ï¼š&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn man(){
    println!(&amp;quot;Hello,World!&amp;quot;);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;è¦å¸¦å‚æ•°ç›´æ¥ &lt;code&gt; name: type&lt;&#x2F;code&gt;å†™åœ¨å‡½æ•°çš„æ‹¬å·é‡Œï¼š&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn man(num: i32){
    println!(&amp;quot;Hello,{num}&amp;quot;);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;yu-ju-he-biao-da-shi&quot;&gt;è¯­å¥å’Œè¡¨è¾¾å¼&lt;&#x2F;h3&gt;
&lt;p&gt;è¯­å¥ï¼šæ‰§è¡Œä¸€äº›æ“ä½œï¼Œä½†ä¸è¿”å›å€¼&lt;&#x2F;p&gt;
&lt;p&gt;è¡¨è¾¾å¼ï¼šæ‰§è¡Œæ“ä½œï¼Œå¹¶ä¸”è¿”å›å€¼ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨å¹³æ—¶å†™çš„ &lt;code&gt; let x = 6&lt;&#x2F;code&gt;å°±æ˜¯ä¸€ä¸ªè¯­å¥ï¼Œ&lt;&#x2F;p&gt;
&lt;p&gt;å‡½æ•°å®šä¹‰ä¹Ÿæ˜¯è¯­å¥.&lt;&#x2F;p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œä¸èƒ½æŠŠ &lt;code&gt;let&lt;&#x2F;code&gt; è¯­å¥èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªæ —å­ï¼š&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let x = {let y = 3};
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å‡½æ•°è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚å®è°ƒç”¨æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚ç”¨å¤§æ‹¬å·åˆ›å»ºçš„ä¸€ä¸ªæ–°çš„å—ä½œç”¨åŸŸä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let x = {
        let y = 2;
        y + 2&#x2F;&#x2F;æ³¨æ„è¿™é‡Œæ²¡æœ‰åˆ†å·ï¼Œå¦‚æœæœ‰åˆ†å·å°±æ˜¯è¯­å¥äº†ï¼Œä¸ä¼šè¿”å›åªç»™x
    };
    println!(&amp;quot;{x}&amp;quot;);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;dai-fan-hui-zhi-de-han-shu&quot;&gt;å¸¦è¿”å›å€¼çš„å‡½æ•°&lt;&#x2F;h3&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn man() -&amp;gt; u32{
    5
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;kong-zhi-liu&quot;&gt;æ§åˆ¶æµ&lt;&#x2F;h2&gt;
&lt;h3 id=&quot;ifyu-ju&quot;&gt;&lt;code&gt; if&lt;&#x2F;code&gt;è¯­å¥&lt;&#x2F;h3&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let num = 5;
    if num &amp;gt; 4 {
        println!(&amp;quot;num is big!&amp;quot;);
    } else {
        println!(&amp;quot;num is small!&amp;quot;);
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æ³¨æ„ï¼Œæ¡ä»¶ä¸€å®šæ—¶ &lt;code&gt; bool&lt;&#x2F;code&gt;ç±»å‹ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å½“ç„¶ï¼Œ&lt;code&gt; if&lt;&#x2F;code&gt;è¯­å¥å¯ä»¥ç›´æ¥ç»™å˜é‡èµ‹å€¼ï¼&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let condition = true;
    let num = if condition { 6 } else { 5 };
    println!(&amp;quot;{num}&amp;quot;);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;xun-huan&quot;&gt;å¾ªç¯&lt;&#x2F;h3&gt;
&lt;h4 id=&quot;loop&quot;&gt;&lt;code&gt; loop&lt;&#x2F;code&gt;&lt;&#x2F;h4&gt;
&lt;p&gt;&lt;code&gt;loop&lt;&#x2F;code&gt; å…³é”®å­—å‘Šè¯‰ Rust ä¸€éåˆä¸€éåœ°æ‰§è¡Œä¸€æ®µä»£ç ç›´åˆ°ä½ æ˜ç¡®è¦æ±‚åœæ­¢ã€‚&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    loop {
        println!(&amp;quot;Hello,World!&amp;quot;);
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å½“ç„¶ï¼Œå¾ªç¯å½“ä¸­ä¹Ÿæœ‰ &lt;code&gt; break&lt;&#x2F;code&gt;å’Œ &lt;code&gt; continue&lt;&#x2F;code&gt;å…³é”®å­—ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ä»å¾ªç¯ä¸­è¿”å›å€¼&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let mut counter = 0;
    let result = loop {
        counter += 1;
        if counter % 2 == 0{
            break counter * 2;
        }
    };
    println!(&amp;quot;{result}&amp;quot;);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¾ªç¯æ ‡ç­¾ï¼šæ¶ˆé™¤å¤šä¸ªå¾ªç¯ä¹‹é—´çš„æ­§ä¹‰ã€‚&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    &amp;#39;counter1: loop{
        loop{
            &#x2F;&#x2F;ä¸»è¦æ˜¯ä¸ºäº†æ¶ˆé™¤å¤šå±‚å¾ªç¯ä¹‹é—´çš„æ­§ä¹‰ï¼Œå¹¶ä¸åƒå…¶ä»–è¯­è¨€é‚£æ ·ï¼Œç›´æ¥ç»“æŸæœ€é è¿‘çš„é‚£ä¸€å±‚å¾ªç¯ï¼Œä¹Ÿå¯ä»¥ç»“æŸæœ€å¤–é¢çš„å¾ªç¯
            break &amp;#39;counter1;
        }
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h4 id=&quot;while&quot;&gt;&lt;code&gt; while&lt;&#x2F;code&gt;&lt;&#x2F;h4&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let mut counter = 10;
    while counter &amp;gt;= 5 {
        println!(&amp;quot;{counter}&amp;quot;);
        counter -= 1;
    }
    println!(&amp;quot;{counter}&amp;quot;);
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h4 id=&quot;for&quot;&gt;&lt;code&gt; for&lt;&#x2F;code&gt;&lt;&#x2F;h4&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    for i in 1..4 {
        println!(&amp;quot;{i}&amp;quot;);
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä½†å¯¹äºæ•°ç»„è€Œè¨€ï¼Œ&lt;&#x2F;p&gt;
&lt;pre&gt;&lt;code data-lang=&quot;rust&quot;&gt;fn main(){
    let nums = [0, 1, 2, 3, 4];
    for i in nums {
        println!(&amp;quot;{i}&amp;quot;);
    }
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</description>
      </item>
    </channel>
</rss>
