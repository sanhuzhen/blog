<!doctype html>
<html lang="{{ lang | default(value="en") }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta content="width=device-width, initial-scale=1" name="viewport"/>

    {# Title 设置 #}
    {% if page.title %}
      {% set title = page.title %}
    {% elif section.title %}
      {% set title = section.title %}
    {% else %}
      {% set title = config.title %}
    {% endif %}

    {# Author 设置 #}
    {% if page.extra.author %}
      {% set author = page.extra.author %}
    {% elif section.extra.author %}
      {% set author = section.extra.author %}
    {% else %}
      {% set author = config.extra.author %}
    {% endif %}

    {# Description 设置 #}
    {% if page.description %}
      {% set description = page.description | truncate(length=150) %}
    {% elif section.description %}
      {% set description = section.description | truncate(length=150) %}
    {% elif config.description %}
      {% set description = config.description | truncate(length=150) %}
    {% endif %}

    {# 图片 #}
    {% if page.extra.image %}
      {% set image = get_url(path=page.extra.image, trailing_slash=false) %}
    {% elif section.extra.image %}
      {% set image = get_url(path=section.extra.image, trailing_slash=false) %}
    {% elif config.extra.logo %}
      {% set image = get_url(path=config.extra.logo, trailing_slash=false) %}
    {% endif %}

    {# 页面链接 #}
    {% if page.permalink %}
      {% set url = page.permalink %}
    {% elif section.permalink %}
      {% set url = section.permalink %}
    {% else %}
      {% set url = config.base_url %}
    {% endif %}

    <title>{{ title }}</title>

    {# ---- Meta tags ---- #}
    {% block metatags %}
      <meta name="title" content="{{ title }}">
      {% if author %}<meta name="author" content="{{ author }}">{% endif %}
      {% if description %}<meta name="description" content="{{ description }}">{% endif %}
      <meta name="generator" content="Zola">

      <meta property="og:type" content="website">
      <meta property="og:url" content="{{ url | safe }}">
      <meta property="og:title" content="{{ title }}">
      {% if description %}<meta property="og:description" content="{{ description }}">{% endif %}
      {% if image %}<meta property="og:image" content="{{ image }}">{% endif %}
      <meta property="og:site_name" content="{{ config.title }}">

      {% set twitter_card = config.extra.twitter_card | default(value=true) %}
      {% if twitter_card != false %}
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:url" content="{{ url }}">
        <meta name="twitter:title" content="{{ title }}">
        {% if description %}<meta name="twitter:description" content="{{ description }}">{% endif %}
        {% if image %}<meta name="twitter:image" content="{{ image }}">{% endif %}
      {% endif %}

      <link rel="canonical" href="{{ url }}">
      {% if config.extra.logo %}
        <link rel="icon" href="{{ get_url(path=config.extra.logo, trailing_slash=false) }}">
      {% endif %}

      <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "{{ title | safe }}",
        "url": "{{ url | safe }}",
        {% if description %}"description": "{{ description | safe }}",{% endif %}
        {% if author %}
        "author": {
          "@type": "Person",
          "name": "{{ author | safe }}"
        }
        {% endif %}
      }
      </script>
    {% endblock metatags %}

    {# RSS Feed #}
    {% if config.generate_feed %}
    {% block feed %}
      <link rel="alternate" type="application/atom+xml" title="RSS" href="{{ get_url(path='atom.xml', trailing_slash=false) }}">
    {% endblock feed %}
    {% endif %}

    {# CSS 引入 #}
    {% block css %}
      <link rel="stylesheet" href="{{ get_url(path='style.css', trailing_slash=false) | safe }}">
    {% endblock css %}
  </head>

  <body theme="auto">
    <div class="w">
      <header>
        {% if config.extra.header_nav %}
        <nav>
          {% for nav_item in config.extra.header_nav %}
            <a href="{{ get_url(path=nav_item.url, trailing_slash=true) | safe }}"
               {% if nav_item.new_tab %}target="_blank" rel="noreferrer noopener"{% endif %}>
              {{ nav_item.name }}
            </a>
          {% endfor %}
        </nav>
        {% endif %}

        {% block header %}
          <h1>{{ config.title }}</h1>
        {% endblock header %}
      </header>

      <main class="page-content" aria-label="Content">
        {% block content %}{% endblock content %}
      </main>

      <footer>
        {% block footer %}{% endblock footer %}
        {% if config.extra.footer_nav %}
        <nav>
          {% for nav_item in config.extra.footer_nav %}
            <a href="{{ get_url(path=nav_item.url, trailing_slash=true) | safe }}">
              {{ nav_item.name }}
            </a>
          {% endfor %}
        </nav>
        {% endif %}
      </footer>
    </div>
  </body>
</html>